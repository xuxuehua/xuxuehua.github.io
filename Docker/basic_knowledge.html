<!DOCTYPE HTML>
<html>
  <head>
    <link rel="Stylesheet" type="text/css" href="/static/css/style.css">
    <link rel="Stylesheet" type="text/css" href="/static/css/tango.css">
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <link rel="alternate" type="application/atom+xml" href="atom.xml" title="Atom feed">
    <title>basic_knowledge - Xu XueHua</title>
    <meta name="keywords" content="Xu XueHua"/>
    <meta name="description" content="Xu XueHua's public notes"/>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  </head>

  <body>
    <div id="container">
      
<div id="header">
  <div class="post-nav"><a href="/">Home</a>&nbsp;&#187;&nbsp;<a href="/#Docker">Docker</a>&nbsp;&#187;&nbsp;basic_knowledge
    <span class="updated">Page Updated&nbsp;
      2018-10-22 12:57
    </span></div>
</div>
<div class="clearfix"></div>

<div class="page_title">basic_knowledge</div>

  <div class="toc"><span class="toctitle">Table of Contents</span><ul>
<li><a href="#basic_knowledge">basic_knowledge</a><ul>
<li><a href="#_1">简介</a></li>
<li><a href="#_2">核心</a><ul>
<li><a href="#cgroups">Cgroups</a></li>
<li><a href="#namespace">Namespace</a></li>
</ul>
</li>
<li><a href="#_3">本质</a></li>
<li><a href="#_4">缺点</a><ul>
<li><a href="#_5">解决方法</a></li>
</ul>
</li>
<li><a href="#_6">虚拟化方式比较</a></li>
<li><a href="#docker">Docker 版本</a></li>
<li><a href="#_7">安装</a><ul>
<li><a href="#centos">CentOS</a></li>
<li><a href="#dockercom">docker.com</a></li>
</ul>
</li>
<li><a href="#_8">卸载</a></li>
<li><a href="#_9">守护进程</a></li>
<li><a href="#_10">图形用户界面</a></li>
</ul>
</li>
<li><a href="#_11">基本概念</a><ul>
<li><a href="#image">镜像 Image</a><ul>
<li><a href="#rootfs">rootfs</a></li>
<li><a href="#union-fs">分层存储 Union FS</a><ul>
<li><a href="#_12">镜像的实现原理</a></li>
</ul>
</li>
<li><a href="#_13">镜像体积</a></li>
<li><a href="#_14">虚悬镜像</a></li>
<li><a href="#scratch">scratch 镜像</a></li>
<li><a href="#volume">Volume</a></li>
</ul>
</li>
<li><a href="#container">容器 Container</a><ul>
<li><a href="#_15">容器存储层</a></li>
</ul>
</li>
<li><a href="#repository">仓库 Repository</a><ul>
<li><a href="#docker-registry">Docker Registry</a></li>
<li><a href="#registry">公开 Registry</a></li>
<li><a href="#registry_1">私有 Registry</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#docker_1">Docker 数据管理</a><ul>
<li><a href="#_16">数据卷</a><ul>
<li><a href="#_17">创建一个数据卷</a></li>
<li><a href="#_18">查看所有的数据卷</a><ul>
<li><a href="#_19">查看数据卷的具体信息</a></li>
</ul>
</li>
<li><a href="#_20">启动一个挂载数据卷的容器</a></li>
<li><a href="#_21">挂载一个主机目录作为数据卷</a></li>
<li><a href="#_22">挂载一个本地主机文件作为数据卷</a></li>
<li><a href="#_23">删除数据卷</a></li>
</ul>
</li>
<li><a href="#docker-machine">Docker Machine 项目</a><ul>
<li><a href="#_24">安装</a><ul>
<li><a href="#macoswindows">macOS、Windows</a></li>
<li><a href="#linux">Linux</a></li>
</ul>
</li>
<li><a href="#docker-machines">Docker Machines 使用</a><ul>
<li><a href="#_25">本地主机实例</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#docker-swarm">Docker Swarm</a></li>
<li><a href="#docker-machine_1">Docker Machine</a></li>
<li><a href="#docker-compose">Docker Compose</a></li>
<li><a href="#etcd">etcd</a><ul>
<li><a href="#etcd_1">etcd 安装</a><ul>
<li><a href="#_26">二进制文件方式下载</a></li>
<li><a href="#etcdctl">使用 etcdctl</a><ul>
<li><a href="#_27">数据库操作</a></li>
<li><a href="#_28">非数据库操作</a></li>
<li><a href="#_29">命令选项</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><a href="#coreos">CoreOS</a><ul>
<li><a href="#coreos_1">CoreOS 特性</a></li>
<li><a href="#coreos_2">CoreOS 工具介绍</a><ul>
<li><a href="#_30">服务发现</a></li>
<li><a href="#_31">容器管理</a></li>
</ul>
</li>
<li><a href="#coreos_3">快速搭建 CoreOS 集群</a></li>
</ul>
</li>
<li><a href="#kubernetes">Kubernetes</a><ul>
<li><a href="#_32">项目简介</a><ul>
<li><a href="#_33">快速上手</a><ul>
<li><a href="#etcd_2">启动 Etcd 服务</a></li>
<li><a href="#_34">启动主节点</a></li>
<li><a href="#_35">启动服务代理</a></li>
<li><a href="#_36">测试状态</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<h1 id="basic_knowledge">basic_knowledge</h1>
<h2 id="_1">简介</h2>
<p>Docker 最初是 dotCloud 公司创始人 Solomon Hykes 在法国期间发起的一个公司内部项目，它是基于 dotCloud 公司多年云服务技术的一次革新，并于 2013 年 3 月以 Apache 2.0 授权协议开源，主要项目代码在 GitHub 上进行维护。Docker 项目后来还加入了 Linux 基金会，并成立推动 开放容器联盟。</p>
<h2 id="_2">核心</h2>
<p>容器技术的核心功能，就是通过约束和修改进程的动态表现，为进程创造出一个界限的效果</p>
<p>最核心的原理实际上是为待创建的用户进程</p>
<ol>
<li>启动Linux Namespace</li>
<li>设置指定的Cgroups参数</li>
<li>切换进程的根目录(Change root)</li>
</ol>
<h3 id="cgroups">Cgroups</h3>
<p>Linux Control Group</p>
<p>主要是限制一个进程组能够使用的资源上线，包括CPU，内存，磁盘，网络，带宽等</p>
<p>即Linux 内核中用来为进程设置资源限制的一个重要功能</p>
<p>Cgroups 还能够对进程进行优先级设置，审计，以及将进程挂起和恢复等操作</p>
<h3 id="namespace">Namespace</h3>
<p>用来修改进程视图的主要方法，即对被隔离应用的进程空间做了手脚，使其自认为是pid=1的进程，而在宿主机上，是原来的其他进程</p>
<p>即创建容器进程时，指定来这个进程所需要启动的一组Namespace 参数</p>
<div class="hlcode"><pre><span class="n">docker</span> <span class="n">run</span> <span class="o">-</span><span class="n">it</span> <span class="n">busybox</span> <span class="o">/</span><span class="n">bin</span><span class="o">/</span><span class="n">sh</span>

<span class="nl">Status:</span> <span class="n">Downloaded</span> <span class="n">newer</span> <span class="n">image</span> <span class="k">for</span> <span class="n">busybox</span><span class="o">:</span><span class="n">latest</span>
<span class="o">/</span> <span class="err">#</span> <span class="n">ps</span>
<span class="n">PID</span>   <span class="n">USER</span>     <span class="n">TIME</span>  <span class="n">COMMAND</span>
    <span class="mi">1</span> <span class="n">root</span>      <span class="mi">0</span><span class="o">:</span><span class="mo">00</span> <span class="o">/</span><span class="n">bin</span><span class="o">/</span><span class="n">sh</span>
    <span class="mi">6</span> <span class="n">root</span>      <span class="mi">0</span><span class="o">:</span><span class="mo">00</span> <span class="n">ps</span>
<span class="o">/</span> <span class="err">#</span>
</pre></div>


<blockquote>
<p>这里/bin/sh PID为1， 但在宿主机，就不是1</p>
</blockquote>
<h2 id="_3">本质</h2>
<p>容器的本质就是一个进程，用户的应用进程实际上就是容器里 PID=1 的进程，也是其他后续创建的所有进程的父进程。这就意味着，在一个容器中，你没办法同时运行两个不同的应用，除非你能事先找到一个公共的 PID=1 的程序来充当两个不同应用的父进程，这也是为什么很多人都会用 systemd 或者 supervisord 这样的软件来代替应用本身作为容器的启动进程。</p>
<h2 id="_4">缺点</h2>
<p>在Linux内核中，很多资源时不可以被Namespace化的，比如时间</p>
<p>如果容器中的程序使用settimeofday(2) 系统调用修改了时间，整个宿主机的时间就会被更改</p>
<h3 id="_5">解决方法</h3>
<p>Linux下的/proc 目录存储的是记录当前内核运行状态的一组特殊文件</p>
<p>用户可以访问文件获取系统当前进程的信息</p>
<p>但运行top指令发现显示信息为宿主机的相关信息</p>
<p>因为/proc 文件系统并不知道用户通过Cgroups 给容器做了哪些资源限制，</p>
<p>所以可以通过lxcfs来实现此功能</p>
<p>如把宿主机的/var/lib/lxcfs/proc/memoinfo 的文件挂载到Docker 容器的/proc/meminfo 位置后，容器中进程读取相应文件内容时，lxcfs的fuse实现会从容器对应的Cgroup中读取正确的内存限制，获得正确的资源约束</p>
<h2 id="_6">虚拟化方式比较</h2>
<p><img alt="img" src="https://cdn.pbrd.co/images/HJA0XhB.png" /></p>
<blockquote>
<p>容器除了运行其中应用外，基本不消耗额外的系统资源，使得应用的性能很高，同时系统的开销尽量小。传统虚拟机方式运行 10 个不同的应用就要起 10 个虚拟机，而Docker 只需要启动 10 个隔离的应用即可。</p>
</blockquote>
<h2 id="docker">Docker 版本</h2>
<p>CE 版本即社区版（免费，支持周期三个月）</p>
<blockquote>
<p>Docker CE 每月发布一个 edge 版本 (17.03, 17.04, 17.05...)，每三个月发布一个 stable 版本 (17.03, 17.06, 17.09...)</p>
</blockquote>
<p>EE 即企业版，强调安全，付费使用。</p>
<blockquote>
<p>Docker EE 和 stable版本号保持一致，但每个版本提供一年维护。</p>
</blockquote>
<h2 id="_7">安装</h2>
<p>Kitematic 这个图形化工具（官方给出的定义是 Visual Docker Container Management on Mac &amp; Windows），对于熟悉和了解 Docker 是很好的帮助</p>
<h3 id="centos">CentOS</h3>
<p>卸载旧版本</p>
<div class="hlcode"><pre><span class="err">$</span> <span class="n">sudo</span> <span class="n">yum</span> <span class="n">remove</span> <span class="n">docker</span> \
                  <span class="n">docker</span><span class="o">-</span><span class="n">common</span> \
                  <span class="n">docker</span><span class="o">-</span><span class="n">selinux</span> \
                  <span class="n">docker</span><span class="o">-</span><span class="n">engine</span>
</pre></div>


<p>使用 yum 源 安装</p>
<div class="hlcode"><pre><span class="err">$</span> <span class="n">sudo</span> <span class="n">yum</span> <span class="n">install</span> <span class="o">-</span><span class="n">y</span> <span class="n">yum</span><span class="o">-</span><span class="n">utils</span> <span class="n">device</span><span class="o">-</span><span class="n">mapper</span><span class="o">-</span><span class="n">persistent</span><span class="o">-</span><span class="n">data</span> <span class="n">lvm2</span>
</pre></div>


<p>国内源添加（可选）</p>
<div class="hlcode"><pre><span class="err">$</span> <span class="n">sudo</span> <span class="n">yum</span><span class="o">-</span><span class="n">config</span><span class="o">-</span><span class="n">manager</span> \
    <span class="o">--</span><span class="n">add</span><span class="o">-</span><span class="n">repo</span> \
    <span class="nl">https:</span><span class="c1">//mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repo</span>
</pre></div>


<p>官方源添加（可选）   </p>
<div class="hlcode"><pre><span class="err">$</span> <span class="n">sudo</span> <span class="n">yum</span><span class="o">-</span><span class="n">config</span><span class="o">-</span><span class="n">manager</span> \
    <span class="o">--</span><span class="n">add</span><span class="o">-</span><span class="n">repo</span> \
    <span class="nl">https:</span><span class="c1">//download.docker.com/linux/centos/docker-ce.repo</span>
</pre></div>


<p>安装 Docker CE</p>
<div class="hlcode"><pre><span class="err">$</span> <span class="n">sudo</span> <span class="n">yum</span> <span class="n">makecache</span> <span class="n">fast</span>
<span class="err">$</span> <span class="n">sudo</span> <span class="n">yum</span> <span class="n">install</span> <span class="n">docker</span><span class="o">-</span><span class="n">ce</span>
</pre></div>


<p>使用脚本自动安装</p>
<p>在测试或开发环境中 Docker 官方为了简化安装流程，提供了一套便捷的安装脚本，CentOS 系统上可以使用这套脚本安装：</p>
<div class="hlcode"><pre><span class="err">$</span> <span class="n">curl</span> <span class="o">-</span><span class="n">fsSL</span> <span class="n">get</span><span class="p">.</span><span class="n">docker</span><span class="p">.</span><span class="n">com</span> <span class="o">-</span><span class="n">o</span> <span class="n">get</span><span class="o">-</span><span class="n">docker</span><span class="p">.</span><span class="n">sh</span>
<span class="err">$</span> <span class="n">sudo</span> <span class="n">sh</span> <span class="n">get</span><span class="o">-</span><span class="n">docker</span><span class="p">.</span><span class="n">sh</span> <span class="o">--</span><span class="n">mirror</span> <span class="n">Aliyun</span>
</pre></div>


<p>启动 Docker CE</p>
<div class="hlcode"><pre><span class="err">$</span> <span class="n">sudo</span> <span class="n">systemctl</span> <span class="n">enable</span> <span class="n">docker</span>
<span class="err">$</span> <span class="n">sudo</span> <span class="n">systemctl</span> <span class="n">start</span> <span class="n">docker</span>
</pre></div>


<p>建立 docker 用户组</p>
<p>默认情况下，docker 命令会使用 Unix socket 与 Docker 引擎通讯。而只有 root 用户和 docker 组的用户才可以访问 Docker 引擎的 Unix socket。出于安全考虑，一般 Linux 系统上不会直接使用 root 用户。因此，更好地做法是将需要使用 docker 的用户加入 docker 用户组。</p>
<div class="hlcode"><pre><span class="err">$</span> <span class="n">sudo</span> <span class="n">groupadd</span> <span class="n">docker</span>
<span class="err">$</span> <span class="n">sudo</span> <span class="n">useradd</span> <span class="o">-</span><span class="n">g</span> <span class="n">docker</span> <span class="n">docker</span> <span class="o">-</span><span class="n">s</span> <span class="o">/</span><span class="n">sbin</span><span class="o">/</span><span class="n">nologin</span>
</pre></div>


<h3 id="dockercom">docker.com</h3>
<div class="hlcode"><pre><span class="n">wget</span> <span class="o">-</span><span class="n">qO</span><span class="o">-</span> <span class="n">get</span><span class="p">.</span><span class="n">docker</span><span class="p">.</span><span class="n">com</span> <span class="o">|</span> <span class="n">bash</span> 
</pre></div>


<h2 id="_8">卸载</h2>
<div class="hlcode"><pre><span class="n">dpkg</span> <span class="o">-</span><span class="n">l</span> <span class="o">|</span> <span class="n">grep</span> <span class="o">-</span><span class="n">i</span> <span class="n">docker</span>
<span class="n">sudo</span> <span class="n">apt</span><span class="o">-</span><span class="n">get</span> <span class="n">purge</span> <span class="o">-</span><span class="n">y</span> <span class="n">docker</span><span class="o">-</span><span class="n">engine</span> <span class="n">docker</span> <span class="n">docker</span><span class="p">.</span><span class="n">io</span> <span class="n">docker</span><span class="o">-</span><span class="n">ce</span>  
<span class="n">sudo</span> <span class="n">apt</span><span class="o">-</span><span class="n">get</span> <span class="n">autoremove</span> <span class="o">-</span><span class="n">y</span> <span class="o">--</span><span class="n">purge</span> <span class="n">docker</span><span class="o">-</span><span class="n">engine</span> <span class="n">docker</span> <span class="n">docker</span><span class="p">.</span><span class="n">io</span> <span class="n">docker</span><span class="o">-</span><span class="n">ce</span>  
<span class="n">sudo</span> <span class="n">rm</span> <span class="o">-</span><span class="n">rf</span> <span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">docker</span>
<span class="n">sudo</span> <span class="n">rm</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">apparmor</span><span class="p">.</span><span class="n">d</span><span class="o">/</span><span class="n">docker</span>
<span class="n">sudo</span> <span class="n">groupdel</span> <span class="n">docker</span>
<span class="n">sudo</span> <span class="n">rm</span> <span class="o">-</span><span class="n">rf</span> <span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">run</span><span class="o">/</span><span class="n">docker</span><span class="p">.</span><span class="n">sock</span>
</pre></div>


<h2 id="_9">守护进程</h2>
<p>运行  Docker 守护进程时，可以用 -H 来改变绑定接口的方式，比如 sudo /usr/bin/docker -d -H  tcp://0.0.0.0:2375，如果不想每次都输入这么长的命令，需要加入以下环境变量 </p>
<p>export  DOCKER_HOST="tcp://0.0.0.0:2375"</p>
<h2 id="_10">图形用户界面</h2>
<p>虽然我们可以用命令来控制 docker，但是如果能有一个 web 管理界面，操作什么的会方便很多，比较常见的有</p>
<ul>
<li>Shipyard</li>
<li>Potainer</li>
</ul>
<h1 id="_11">基本概念</h1>
<h2 id="image">镜像 Image</h2>
<p>一个只读的模板，镜像可以用来创建 Docker 容器</p>
<div class="hlcode"><pre><span class="n">docker</span> <span class="n">run</span> <span class="o">-</span><span class="n">d</span> <span class="n">ubuntu</span><span class="o">:</span><span class="n">latest</span> <span class="n">sleep</span> <span class="mi">3600</span>
</pre></div>


<p>这里的Ubuntu 镜像，实际上就是一个Ubuntu操作系统的rootfs，内容是Ubuntu操作系统的所有文件和目录</p>
<p>任何镜像里面的内容都属于只读层，commit之后的东西也属于只读层</p>
<h3 id="rootfs">rootfs</h3>
<p>用于为容器进程提供隔离后执行环境的文件系统，即所谓的容器镜像rootfs</p>
<p>就相当于一个root文件系统。官方镜像Ubuntu:14.04 就包含了完整的一套 Ubuntu 14.04 最小系统的 root 文件系统</p>
<p>镜像不包含任何动态数据，其内容在构建之后也不会被改变。</p>
<p>rootfs只是一个操作系统包含的文件，配置和目录，并不包括系统内核，在Linux系统中，两部分是分开存放的，操作系统只有在开机启动的时候才会夹在指定版本的内核镜像</p>
<h3 id="union-fs">分层存储 Union FS</h3>
<p>Docker 设计时，就充分利用 Union FS 的技术，将其设计为分层存储的架构，即将多个不同位置的目录联合挂载到同一个目录下</p>
<p>镜像构建时，会一层层构建，前一层是后一层的基础。每一层构建完就不会再发生改变，后一层上的任何改变只发生在自己这一层。</p>
<blockquote>
<p>比如，删除前一层文件的操作，实际不是真的删除前一层的文件，而是仅在当前层标记为该文件已删除。在最终容器运行的时候，虽然不会看到这个文件，但是实际上该文件会一直跟随镜像。因此，在构建镜像的时候，需要额外小心，每一层尽量只包含该层需要添加的东西，任何额外的东西应该在该层构建结束前清理掉。</p>
</blockquote>
<p>所有的层都保存在diff目录下</p>
<p>Docker 镜像使用的rootfs，往往由多个层组成</p>
<div class="hlcode"><pre><span class="err">#</span> <span class="nt">docker</span> <span class="nt">image</span> <span class="nt">inspect</span> <span class="nt">ubuntu</span><span class="nd">:latest</span> <span class="o">|</span> <span class="nt">grep</span> <span class="nt">-i</span> <span class="nt">rootfs</span> <span class="nt">-C</span> <span class="nt">12</span>

<span class="s2">&quot;RootFS&quot;</span><span class="o">:</span> <span class="p">{</span>
            <span class="s2">&quot;Type&quot;</span><span class="o">:</span> <span class="s2">&quot;layers&quot;</span><span class="o">,</span>
            <span class="s2">&quot;Layers&quot;</span><span class="o">:</span> <span class="cp">[</span>
                <span class="s2">&quot;sha256:bebe7ce6215aee349bee5d67222abeb5c5a834bbeaa2f2f5d05363d9fd68db41&quot;</span><span class="p">,</span>
                <span class="s2">&quot;sha256:283fb404ea9415ab48456fd8a82b153b1a719491cdf7b806d1853b047d00f27f&quot;</span><span class="p">,</span>
                <span class="s2">&quot;sha256:663e8522d78b5b767f15b2e43885da5975068e3195bbbfa8fc3a082297a361c1&quot;</span><span class="p">,</span>
                <span class="s2">&quot;sha256:4b7d93055d8781d27259ba5780938e6a78d8ef691c94ee9abc3616c1b009ec4a&quot;</span>
            <span class="cp">]</span>
</pre></div>


<blockquote>
<p>这里的每一层即是一个增量的rootfs</p>
</blockquote>
<p>然后将所有增量联合一起挂在在一个统一的挂在点上</p>
<div class="hlcode"><pre><span class="n">root</span><span class="err">@</span><span class="n">localhost</span><span class="o">:~</span><span class="err">#</span> <span class="n">find</span> <span class="o">/</span> <span class="o">-</span><span class="n">name</span> <span class="err">&#39;</span><span class="mf">663e8522</span><span class="n">d78b5b767f15b2e43885da5975068e3195bbbfa8fc3a082297a361c1</span><span class="err">&#39;</span>
<span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">docker</span><span class="o">/</span><span class="n">image</span><span class="o">/</span><span class="n">overlay2</span><span class="o">/</span><span class="n">distribution</span><span class="o">/</span><span class="n">v2metadata</span><span class="o">-</span><span class="n">by</span><span class="o">-</span><span class="n">diffid</span><span class="o">/</span><span class="n">sha256</span><span class="o">/</span><span class="mf">663e8522</span><span class="n">d78b5b767f15b2e43885da5975068e3195bbbfa8fc3a082297a361c1</span>
</pre></div>


<h4 id="_12">镜像的实现原理</h4>
<p>Docker 镜像是怎么实现增量的修改和维护的？ 每个镜像都由很多层次构成，Docker 使用 Union FS 将这些不同的层结合到一个镜像中去。<br />
通常 Union FS 有两个用途, 一方面可以实现不借助 LVM、RAID 将多个 disk 挂到同一个目录下,另一个更常用的就是将一个只读的分支和一个可写的分支联合在一起，Live CD 正是基于此方法可以允许在镜像不变的基础上允许用户在其上进行一些写操作。 Docker 在 AUFS 上构建的容器也是利用了类似的原理。</p>
<p><img alt="img" src="https://snag.gy/96p30S.jpg" /></p>
<p>init 层，用来存放临时修改过的/etc/hosts等文件</p>
<p>Copy on Write 存放任何对只读层的修改，容器声明的Volume挂载点，也出现在这一层</p>
<h3 id="_13">镜像体积</h3>
<p>Docker Hub 中显示的体积是压缩后的体积。在镜像下载和上传过程中镜像是保持着压缩状态的，因此 Docker Hub 所显示的大小是网络传输中更关心的流量大小。</p>
<h3 id="_14">虚悬镜像</h3>
<p>镜像既没有仓库名，也没有标签，均为 <code>&lt;none&gt;</code></p>
<blockquote>
<p>这个镜像原本是有镜像名和标签的，原来为 mongo:3.2，随着官方镜像维护，发布了新版本后，重新 docker pull mongo:3.2 时，mongo:3.2 这个镜像名被转移到了新下载的镜像身上，而旧的镜像上的这个名称则被取消，从而成为了 <code>&lt;none&gt;</code>。<br />
docker build 也同样可以导致这种现象。由于新旧镜像同名，旧镜像名称被取消，从而出现仓库名、标签均为 <code>&lt;none&gt;</code> 的镜像</p>
</blockquote>
<div class="hlcode"><pre><span class="err">$</span> <span class="nx">docker</span> <span class="nx">images</span>
<span class="nx">REPOSITORY</span>           <span class="kt">TAG</span>                 <span class="nb">IMAGE</span> <span class="nb">ID</span>            <span class="nx">CREATED</span>             <span class="nb">SIZE</span>
<span class="nx">redis</span>                <span class="nx">latest</span>              <span class="mi">5</span><span class="nx">f515359c7f8</span>        <span class="mi">5</span> <span class="nb">days</span> <span class="nx">ago</span>          <span class="mi">183</span> <span class="nx">MB</span>
<span class="nx">nginx</span>                <span class="nx">latest</span>              <span class="mi">05</span><span class="nx">a60462f8ba</span>        <span class="mi">5</span> <span class="nb">days</span> <span class="nx">ago</span>          <span class="mi">181</span> <span class="nx">MB</span>
<span class="nx">mongo</span>                <span class="mf">3.2</span>                 <span class="nx">fe9198c04d62</span>        <span class="mi">5</span> <span class="nb">days</span> <span class="nx">ago</span>          <span class="mi">342</span> <span class="nx">MB</span>
<span class="o">&lt;</span><span class="kc">none</span><span class="o">&gt;</span>               <span class="o">&lt;</span><span class="kc">none</span><span class="o">&gt;</span>              <span class="mi">00285</span><span class="nx">df0df87</span>        <span class="mi">5</span> <span class="nb">days</span> <span class="nx">ago</span>          <span class="mi">342</span> <span class="nx">MB</span>
<span class="nx">ubuntu</span>               <span class="mf">16.04</span>               <span class="nx">f753707788c5</span>        <span class="mi">4</span> <span class="nx">weeks</span> <span class="nx">ago</span>         <span class="mi">127</span> <span class="nx">MB</span>
<span class="nx">ubuntu</span>               <span class="nx">latest</span>              <span class="nx">f753707788c5</span>        <span class="mi">4</span> <span class="nx">weeks</span> <span class="nx">ago</span>         <span class="mi">127</span> <span class="nx">MB</span>
<span class="nx">ubuntu</span>               <span class="mf">14.04</span>               <span class="mi">1</span><span class="nx">e0c3dd64ccd</span>        <span class="mi">4</span> <span class="nx">weeks</span> <span class="nx">ago</span>         <span class="mi">188</span> <span class="nx">MB</span>
</pre></div>


<h3 id="scratch">scratch 镜像</h3>
<p>本身即是空镜像，万能的base镜像</p>
<p>如centos等镜像的FROM处</p>
<h3 id="volume">Volume</h3>
<p>允许将宿主机指定的目录或者文件，挂载到容器里面进行读取和修改操作</p>
<p>容器volume里面的信息，并不会被docker commit 提交掉</p>
<p>Volume 的本质是宿主机上的一个独立目录，不属于rootfs的一部分</p>
<h2 id="container">容器 Container</h2>
<p>镜像（Image）和容器（Container）的关系，就像是面向对象程序设计中的类和实例一样</p>
<p>可以被启动、开始、停止、删除。每个容器都是相互隔离的、保证安全的平台</p>
<p>容器的实质是进程，但与直接在宿主执行的进程不同，容器进程运行于属于自己的独立的 命名空间。</p>
<p>容器可以拥有自己的 root 文件系统、自己的网络配置、自己的进程空间，甚至自己的用户 ID 空间。</p>
<h3 id="_15">容器存储层</h3>
<p>每一个容器运行时，是以镜像为基础层，在其上创建一个当前容器的存储层</p>
<p>容器存储层的生存周期和容器一样，容器消亡时，容器存储层也随之消亡。因此，任何保存于容器存储层的信息都会随容器删除而丢失。</p>
<blockquote>
<p>按照 Docker 最佳实践的要求，容器不应该向其存储层内写入任何数据，容器存储层要保持无状态化。所有的文件写入操作，都应该使用 数据卷（Volume）、或者绑定宿主目录，在这些位置的读写会跳过容器存储层，直接对宿主(或网络存储)发生读写，其性能和稳定性更高。</p>
</blockquote>
<h2 id="repository">仓库 Repository</h2>
<p>即Docker Store，存储和分享docker images</p>
<p>集中存放镜像文件的场所，可以是公有的，也可以是私有的</p>
<p>最大的公开仓库是 Docker Hub</p>
<p>国内的公开仓库包括 Docker Pool 等</p>
<p>当用户创建了自己的镜像之后就可以使用 push 命令将它上传到公有或者私有仓库，这样下次在另外一台机器上使用这个镜像时候，只需要从仓库上 pull 下来就可以了</p>
<p>Docker 仓库的概念跟 Git 类似，注册服务器可以理解为 GitHub 这样的托管服务</p>
<h3 id="docker-registry">Docker Registry</h3>
<p>集中的存储、分发镜像的服务</p>
<p>一个 Docker Registry 中可以包含多个仓库（Repository）；每个仓库可以包含多个标签（Tag）；每个标签对应一个镜像</p>
<blockquote>
<p>以 Ubuntu 镜像 为例，ubuntu 是仓库的名字，其内包含有不同的版本标签，如，14.04, 16.04。我们可以通过 ubuntu:14.04，或者 ubuntu:16.04 来具体指定所需哪个版本的镜像。如果忽略了标签，比如 ubuntu，那将视为 ubuntu:latest。</p>
</blockquote>
<p>仓库名经常以 两段式路径 形式出现，比如 jwilder/nginx-proxy，前者往往意味着 Docker Registry 多用户环境下的用户名，后者则往往是对应的软件名。但这并非绝对，取决于所使用的具体 Docker Registry 的软件或服务。</p>
<h3 id="registry">公开 Registry</h3>
<p>最常使用的 Registry 公开服务是官方的 Docker Hub</p>
<blockquote>
<p>这也是默认的 Registry，并拥有大量的高质量的官方镜像。除此以外，还有 CoreOS 的 Quay.io</p>
</blockquote>
<p>国内的一些云服务商提供了针对 Docker Hub 的镜像服务（Registry Mirror），这些镜像服务被称为加速器。</p>
<blockquote>
<p>常见的有 阿里云加速器、DaoCloud 加速器、灵雀云加速器等。使用加速器会直接从国内的地址下载 Docker Hub 的镜像，比直接从官方网站下载速度会提高很多。</p>
</blockquote>
<p>国内也有一些云服务商提供类似于 Docker Hub 的公开服务</p>
<blockquote>
<p>比如 时速云镜像仓库、网易云镜像服务、DaoCloud 镜像市场、阿里云镜像库等。</p>
</blockquote>
<h3 id="registry_1">私有 Registry</h3>
<p>Docker 官方提供了 Docker Registry 镜像，可以直接使用做为私有 Registry 服务。</p>
<blockquote>
<p>开源的 Docker Registry 镜像只提供了 Docker Registry API 的服务端实现，足以支持 docker 命令，不影响使用。但不包含图形界面，以及镜像维护、用户管理、访问控制等高级功能。在官方的商业化版本 Docker Trusted Registry 中，提供了这些高级功能。</p>
</blockquote>
<p>第三方软件实现了 Docker Registry API</p>
<blockquote>
<p>甚至提供了用户界面以及一些高级功能。比如，VMWare Harbor 和 Sonatype Nexus。</p>
</blockquote>
<h1 id="docker_1">Docker 数据管理</h1>
<h2 id="_16">数据卷</h2>
<ul>
<li>数据卷是一个可供一个或多个容器使用的特殊目录</li>
<li>数据卷可以在容器之间共享和重用</li>
<li>对数据卷的修改会立马生效</li>
<li>对数据卷的更新，不会影响镜像</li>
<li>数据卷默认会一直存在，即使容器被删除</li>
</ul>
<blockquote>
<p>注意：数据卷的使用，类似于 Linux 下对目录或文件进行 mount，镜像中的被指定为挂载点的目录中的文件会隐藏掉，能显示看的是挂载的数据卷。</p>
</blockquote>
<h3 id="_17">创建一个数据卷</h3>
<ul>
<li><code>-v</code></li>
<li><code>-–mount</code></li>
</ul>
<div class="hlcode"><pre><span class="err">$</span> <span class="n">docker</span> <span class="n">volume</span> <span class="n">create</span> <span class="n">my</span><span class="o">-</span><span class="n">vol</span>
</pre></div>


<h3 id="_18">查看所有的数据卷</h3>
<div class="hlcode"><pre><span class="err">$</span> <span class="n">docker</span> <span class="n">volume</span> <span class="n">ls</span>

<span class="n">local</span>               <span class="n">my</span><span class="o">-</span><span class="n">vol</span>
</pre></div>


<div class="hlcode"><pre><span class="err">$</span> <span class="nt">docker</span> <span class="nt">volume</span> <span class="nt">inspect</span> <span class="nt">my-vol</span>
<span class="cp">[</span>
    <span class="p">{</span>
        <span class="s2">&quot;Driver&quot;</span><span class="p">:</span> <span class="s2">&quot;local&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Labels&quot;</span><span class="p">:</span> <span class="p">{},</span>
        <span class="s2">&quot;Mountpoint&quot;</span><span class="p">:</span> <span class="s2">&quot;/var/lib/docker/volumes/my-vol/_data&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Name&quot;</span><span class="p">:</span> <span class="s2">&quot;my-vol&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Options&quot;</span><span class="p">:</span> <span class="p">{},</span>
        <span class="s2">&quot;Scope&quot;</span><span class="p">:</span> <span class="s2">&quot;local&quot;</span>
    <span class="p">}</span>
<span class="cp">]</span>
</pre></div>


<h4 id="_19">查看数据卷的具体信息</h4>
<p>在主机里使用以下命令可以查看 web 容器的信息</p>
<div class="hlcode"><pre><span class="err">$</span> <span class="n">docker</span> <span class="n">inspect</span> <span class="n">web</span>
</pre></div>


<h3 id="_20">启动一个挂载数据卷的容器</h3>
<ul>
<li>使用 --mount 标记来将数据卷挂载到容器里</li>
</ul>
<div class="hlcode"><pre><span class="err">$</span> <span class="n">docker</span> <span class="n">run</span> <span class="o">-</span><span class="n">d</span> <span class="o">-</span><span class="n">P</span> \
    <span class="o">--</span><span class="n">name</span> <span class="n">web</span> \
    <span class="o">--</span><span class="n">mount</span> <span class="n">source</span><span class="o">=</span><span class="n">my</span><span class="o">-</span><span class="n">vol</span><span class="p">,</span><span class="n">target</span><span class="o">=/</span><span class="n">webapp</span> \
    <span class="n">training</span><span class="o">/</span><span class="n">webapp</span> \
    <span class="n">python</span> <span class="n">app</span><span class="p">.</span><span class="n">py</span>
</pre></div>


<h3 id="_21">挂载一个主机目录作为数据卷</h3>
<ul>
<li>使用 --mount 标记可以指定挂载一个本地主机的目录到容器中去。</li>
</ul>
<div class="hlcode"><pre><span class="err">$</span> <span class="n">docker</span> <span class="n">run</span> <span class="o">-</span><span class="n">d</span> <span class="o">-</span><span class="n">P</span> \
    <span class="o">--</span><span class="n">name</span> <span class="n">web</span> \
    <span class="err">#</span> <span class="o">-</span><span class="n">v</span> <span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">webapp</span><span class="o">:/</span><span class="n">opt</span><span class="o">/</span><span class="n">webapp</span> \
    <span class="o">--</span><span class="n">mount</span> <span class="n">type</span><span class="o">=</span><span class="n">bind</span><span class="p">,</span><span class="n">source</span><span class="o">=/</span><span class="n">src</span><span class="o">/</span><span class="n">webapp</span><span class="p">,</span><span class="n">target</span><span class="o">=/</span><span class="n">opt</span><span class="o">/</span><span class="n">webapp</span> \
    <span class="n">training</span><span class="o">/</span><span class="n">webapp</span> \
    <span class="n">python</span> <span class="n">app</span><span class="p">.</span><span class="n">py</span>
</pre></div>


<ul>
<li>Docker 挂载主机目录的默认权限是 读写，用户也可以通过增加 readonly 指定为 只读。</li>
</ul>
<div class="hlcode"><pre><span class="err">$</span> <span class="n">docker</span> <span class="n">run</span> <span class="o">-</span><span class="n">d</span> <span class="o">-</span><span class="n">P</span> \
    <span class="o">--</span><span class="n">name</span> <span class="n">web</span> \
    <span class="err">#</span> <span class="o">-</span><span class="n">v</span> <span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">webapp</span><span class="o">:/</span><span class="n">opt</span><span class="o">/</span><span class="n">webapp</span><span class="o">:</span><span class="n">ro</span> \
    <span class="o">--</span><span class="n">mount</span> <span class="n">type</span><span class="o">=</span><span class="n">bind</span><span class="p">,</span><span class="n">source</span><span class="o">=/</span><span class="n">src</span><span class="o">/</span><span class="n">webapp</span><span class="p">,</span><span class="n">target</span><span class="o">=/</span><span class="n">opt</span><span class="o">/</span><span class="n">webapp</span><span class="p">,</span><span class="n">readonly</span> \
    <span class="n">training</span><span class="o">/</span><span class="n">webapp</span> \
    <span class="n">python</span> <span class="n">app</span><span class="p">.</span><span class="n">py</span>
</pre></div>


<h3 id="_22">挂载一个本地主机文件作为数据卷</h3>
<ul>
<li>--mount 标记也可以从主机挂载单个文件到容器中</li>
</ul>
<div class="hlcode"><pre><span class="err">$</span> <span class="n">docker</span> <span class="n">run</span> <span class="o">--</span><span class="n">rm</span> <span class="o">-</span><span class="n">it</span> \
   <span class="err">#</span> <span class="o">-</span><span class="n">v</span> <span class="err">$</span><span class="n">HOME</span><span class="o">/</span><span class="p">.</span><span class="n">bash_history</span><span class="o">:/</span><span class="n">root</span><span class="o">/</span><span class="p">.</span><span class="n">bash_history</span> \
   <span class="o">--</span><span class="n">mount</span> <span class="n">type</span><span class="o">=</span><span class="n">bind</span><span class="p">,</span><span class="n">source</span><span class="o">=</span><span class="err">$</span><span class="n">HOME</span><span class="o">/</span><span class="p">.</span><span class="n">bash_history</span><span class="p">,</span><span class="n">target</span><span class="o">=/</span><span class="n">root</span><span class="o">/</span><span class="p">.</span><span class="n">bash_history</span> \
   <span class="nl">ubuntu:</span><span class="mf">17.10</span> \
   <span class="n">bash</span>

<span class="n">root</span><span class="err">@</span><span class="mi">2</span><span class="n">affd44b4667</span><span class="o">:/</span><span class="err">#</span> <span class="n">history</span>
<span class="mi">1</span>  <span class="n">ls</span>
<span class="mi">2</span>  <span class="n">diskutil</span> <span class="n">list</span>
</pre></div>


<h3 id="_23">删除数据卷</h3>
<div class="hlcode"><pre><span class="err">$</span> <span class="n">docker</span> <span class="n">volume</span> <span class="n">rm</span> <span class="n">my</span><span class="o">-</span><span class="n">vol</span>
</pre></div>


<blockquote>
<p>数据卷是被设计用来持久化数据的，它的生命周期独立于容器，Docker 不会在容器被删除后自动删除数据卷，并且也不存在垃圾回收这样的机制来处理没有任何容器引用的数据卷。</p>
</blockquote>
<ul>
<li>
<p>如果需要在删除容器的同时移除数据卷。可以在删除容器的时候使用 docker rm -v 这个命令。</p>
</li>
<li>
<p>无主的数据卷可能会占据很多空间，要清理请使用以下命令</p>
</li>
</ul>
<div class="hlcode"><pre><span class="err">$</span> <span class="n">docker</span> <span class="n">volume</span> <span class="n">prune</span>
</pre></div>


<h2 id="docker-machine">Docker Machine 项目</h2>
<ul>
<li>Docker Machine 是 Docker 官方编排（Orchestration）项目之一，负责在多种平台上快速安装 Docker 环境。</li>
</ul>
<h3 id="_24">安装</h3>
<h4 id="macoswindows">macOS、Windows</h4>
<div class="hlcode"><pre><span class="err">$</span> <span class="n">docker</span><span class="o">-</span><span class="n">machine</span> <span class="o">-</span><span class="n">v</span>
<span class="n">docker</span><span class="o">-</span><span class="n">machine</span> <span class="n">version</span> <span class="mf">0.13.0</span><span class="p">,</span> <span class="n">build</span> <span class="mi">9</span><span class="n">ba6da9</span>
</pre></div>


<h4 id="linux">Linux</h4>
<div class="hlcode"><pre><span class="n">curl</span> <span class="o">-</span><span class="n">L</span> <span class="n">https</span><span class="o">:</span><span class="c1">//github.com/docker/machine/releases/download/v0.13.0/docker-machine-`uname -s`-`uname -m` &gt;/tmp/docker-machine &amp;&amp;</span>
<span class="n">chmod</span> <span class="o">+</span><span class="n">x</span> <span class="o">/</span><span class="n">tmp</span><span class="o">/</span><span class="n">docker</span><span class="o">-</span><span class="n">machine</span> <span class="o">&amp;&amp;</span>
<span class="n">sudo</span> <span class="n">cp</span> <span class="o">/</span><span class="n">tmp</span><span class="o">/</span><span class="n">docker</span><span class="o">-</span><span class="n">machine</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="n">bin</span><span class="o">/</span><span class="n">docker</span><span class="o">-</span><span class="n">machine</span>
</pre></div>


<ul>
<li>完成后，查看版本信息</li>
</ul>
<div class="hlcode"><pre><span class="err">$</span> <span class="n">docker</span><span class="o">-</span><span class="n">machine</span> <span class="o">-</span><span class="n">v</span>
<span class="n">docker</span><span class="o">-</span><span class="n">machine</span> <span class="n">version</span> <span class="mf">0.13.0</span><span class="p">,</span> <span class="n">build</span> <span class="mi">9</span><span class="n">ba6da9</span>
</pre></div>


<h3 id="docker-machines">Docker Machines 使用</h3>
<ul>
<li>Docker Machine 支持多种后端驱动，包括虚拟机、本地主机和云平台等。</li>
</ul>
<h4 id="_25">本地主机实例</h4>
<ul>
<li>使用 virtualbox 类型的驱动，创建一台 Docker 主机，命名为 test。</li>
</ul>
<div class="hlcode"><pre><span class="err">$</span> <span class="n">docker</span><span class="o">-</span><span class="n">machine</span> <span class="n">create</span> <span class="o">-</span><span class="n">d</span> <span class="n">virtualbox</span> <span class="n">test</span>
</pre></div>


<ul>
<li>查看主机</li>
</ul>
<div class="hlcode"><pre><span class="err">$</span> <span class="n">docker</span><span class="o">-</span><span class="n">machine</span> <span class="n">ls</span>

<span class="n">NAME</span>      <span class="n">ACTIVE</span>   <span class="n">DRIVER</span>       <span class="n">STATE</span>     <span class="n">URL</span>                         <span class="n">SWARM</span>   <span class="n">DOCKER</span>       <span class="n">ERRORS</span>
<span class="n">test</span>      <span class="o">-</span>        <span class="n">virtualbox</span>   <span class="n">Running</span>   <span class="n">tcp</span><span class="o">:</span><span class="c1">//192.168.99.187:2376           v17.10.0-ce</span>
</pre></div>


<h2 id="docker-swarm">Docker Swarm</h2>
<p>Docker Swarm 是 Docker 官方三剑客项目之一，提供 Docker 容器集群服务，是 Docker 官方对容器云生态进行支持的核心方案。</p>
<h2 id="docker-machine_1">Docker Machine</h2>
<p>将主机配置成可以加入到Swarm集群中里面</p>
<h2 id="docker-compose">Docker Compose</h2>
<p>仅适合单机的容器编排工具</p>
<h2 id="etcd">etcd</h2>
<p>etcd 是 CoreOS 团队发起的一个管理配置信息和服务发现（service discovery）的项目</p>
<p>etcd 是 CoreOS 团队于 2013 年 6 月发起的开源项目，它的目标是构建一个高可用的分布式键值（key-value）数据库，基于 Go 语言实现。</p>
<p>受到 Apache ZooKeeper 项目和 doozer 项目的启发，etcd 在设计的时候重点考虑了下面四个要素：<br />
简单：支持 REST 风格的 HTTP+JSON API<br />
安全：支持 HTTPS 方式的访问<br />
快速：支持并发 1k/s 的写操作<br />
可靠：支持分布式结构，基于 Raft 的一致性算法</p>
<p>一般情况下，用户使用 etcd 可以在多个节点上启动多个实例，并添加它们为一个集群。同一个集群中的 etcd 实例将会保持彼此信息的一致性。</p>
<h3 id="etcd_1">etcd 安装</h3>
<ul>
<li>etcd 基于 Go 语言实现，因此，用户可以从 项目主页 下载源代码自行编译，也可以下载编译好的二进制文件，甚至直接使用制作好的 Docker 镜像文件来体验。</li>
</ul>
<h4 id="_26">二进制文件方式下载</h4>
<ul>
<li>编译好的二进制文件都在 github.com/coreos/etcd/releases 页面，用户可以选择需要的版本，或通过下载工具下载</li>
</ul>
<div class="hlcode"><pre><span class="n">curl</span> <span class="o">-</span><span class="n">L</span>  <span class="n">https</span><span class="o">:</span><span class="c1">//github.com/coreos/etcd/releases/download/v3.1.11/etcd-v3.1.11-linux-amd64.tar.gz -o etcd-v3.1.11-linux-amd64.tar.gz</span>
<span class="n">tar</span> <span class="n">xzvf</span> <span class="n">etcd</span><span class="o">-</span><span class="n">v3</span><span class="mf">.1.11</span><span class="o">-</span><span class="n">linux</span><span class="o">-</span><span class="n">amd64</span><span class="p">.</span><span class="n">tar</span><span class="p">.</span><span class="n">gz</span>
<span class="n">cd</span> <span class="n">etcd</span><span class="o">-</span><span class="n">v3</span><span class="mf">.1.11</span><span class="o">-</span><span class="n">linux</span><span class="o">-</span><span class="n">amd64</span><span class="p">.</span><span class="n">tar</span><span class="p">.</span><span class="n">gz</span>
</pre></div>


<ul>
<li>其中 etcd 是服务主文件，etcdctl 是提供给用户的命令客户端，etcd-migrate 负责进行迁移。<br />
  推荐通过下面的命令将三个文件都放到系统可执行目录 /usr/local/bin/ 或 /usr/bin/。</li>
</ul>
<div class="hlcode"><pre><span class="err">$</span> <span class="n">sudo</span> <span class="n">cp</span> <span class="n">etcd</span><span class="o">*</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="n">bin</span><span class="o">/</span>
</pre></div>


<ul>
<li>运行 etcd，将默认组建一个两个节点的集群。数据库服务端默认监听在 2379 和 4001 端口，etcd 实例监听在 2380 和 7001 端口。显示类似如下的信息：</li>
</ul>
<div class="hlcode"><pre><span class="p">[</span><span class="n">root</span><span class="err">@</span><span class="n">nagios</span> <span class="n">etcd</span><span class="o">-</span><span class="n">v3</span><span class="mf">.1.11</span><span class="o">-</span><span class="n">linux</span><span class="o">-</span><span class="n">amd64</span><span class="p">]</span><span class="err">#</span> <span class="n">etcd</span>
<span class="mi">2017</span><span class="o">-</span><span class="mi">12</span><span class="o">-</span><span class="mo">02</span> <span class="mi">08</span><span class="o">:</span><span class="mi">28</span><span class="o">:</span><span class="mf">04.518576</span> <span class="n">I</span> <span class="o">|</span> <span class="n">etcdmain</span><span class="o">:</span> <span class="n">etcd</span> <span class="n">Version</span><span class="o">:</span> <span class="mf">3.1.11</span>
<span class="mi">2017</span><span class="o">-</span><span class="mi">12</span><span class="o">-</span><span class="mo">02</span> <span class="mi">08</span><span class="o">:</span><span class="mi">28</span><span class="o">:</span><span class="mf">04.518616</span> <span class="n">I</span> <span class="o">|</span> <span class="n">etcdmain</span><span class="o">:</span> <span class="n">Git</span> <span class="n">SHA</span><span class="o">:</span> <span class="mf">960f</span><span class="mi">4604</span><span class="n">b</span>
<span class="mi">2017</span><span class="o">-</span><span class="mi">12</span><span class="o">-</span><span class="mo">02</span> <span class="mi">08</span><span class="o">:</span><span class="mi">28</span><span class="o">:</span><span class="mf">04.518619</span> <span class="n">I</span> <span class="o">|</span> <span class="n">etcdmain</span><span class="o">:</span> <span class="n">Go</span> <span class="n">Version</span><span class="o">:</span> <span class="n">go1</span><span class="mf">.8.5</span>
<span class="mi">2017</span><span class="o">-</span><span class="mi">12</span><span class="o">-</span><span class="mo">02</span> <span class="mi">08</span><span class="o">:</span><span class="mi">28</span><span class="o">:</span><span class="mf">04.518622</span> <span class="n">I</span> <span class="o">|</span> <span class="n">etcdmain</span><span class="o">:</span> <span class="n">Go</span> <span class="n">OS</span><span class="o">/</span><span class="n">Arch</span><span class="o">:</span> <span class="n">linux</span><span class="o">/</span><span class="n">amd64</span>
<span class="mi">2017</span><span class="o">-</span><span class="mi">12</span><span class="o">-</span><span class="mo">02</span> <span class="mi">08</span><span class="o">:</span><span class="mi">28</span><span class="o">:</span><span class="mf">04.518626</span> <span class="n">I</span> <span class="o">|</span> <span class="n">etcdmain</span><span class="o">:</span> <span class="n">setting</span> <span class="n">maximum</span> <span class="n">number</span> <span class="n">of</span> <span class="n">CPUs</span> <span class="n">to</span> <span class="mi">1</span><span class="p">,</span> <span class="n">total</span> <span class="n">number</span> <span class="n">of</span> <span class="n">available</span> <span class="n">CPUs</span> <span class="n">is</span> <span class="mi">1</span>
<span class="mi">2017</span><span class="o">-</span><span class="mi">12</span><span class="o">-</span><span class="mo">02</span> <span class="mi">08</span><span class="o">:</span><span class="mi">28</span><span class="o">:</span><span class="mf">04.518632</span> <span class="n">W</span> <span class="o">|</span> <span class="n">etcdmain</span><span class="o">:</span> <span class="n">no</span> <span class="n">data</span><span class="o">-</span><span class="n">dir</span> <span class="n">provided</span><span class="p">,</span> <span class="n">using</span> <span class="k">default</span> <span class="n">data</span><span class="o">-</span><span class="n">dir</span> <span class="p">.</span><span class="o">/</span><span class="k">default</span><span class="p">.</span><span class="n">etcd</span>
<span class="mi">2017</span><span class="o">-</span><span class="mi">12</span><span class="o">-</span><span class="mo">02</span> <span class="mi">08</span><span class="o">:</span><span class="mi">28</span><span class="o">:</span><span class="mf">04.518895</span> <span class="n">I</span> <span class="o">|</span> <span class="n">embed</span><span class="o">:</span> <span class="n">listening</span> <span class="k">for</span> <span class="n">peers</span> <span class="n">on</span> <span class="n">http</span><span class="o">:</span><span class="c1">//localhost:2380</span>
<span class="mi">2017</span><span class="o">-</span><span class="mi">12</span><span class="o">-</span><span class="mo">02</span> <span class="mi">08</span><span class="o">:</span><span class="mi">28</span><span class="o">:</span><span class="mf">04.519026</span> <span class="n">I</span> <span class="o">|</span> <span class="n">embed</span><span class="o">:</span> <span class="n">listening</span> <span class="k">for</span> <span class="n">client</span> <span class="n">requests</span> <span class="n">on</span> <span class="n">localhost</span><span class="o">:</span><span class="mi">2379</span>
<span class="mi">2017</span><span class="o">-</span><span class="mi">12</span><span class="o">-</span><span class="mo">02</span> <span class="mi">08</span><span class="o">:</span><span class="mi">28</span><span class="o">:</span><span class="mf">04.531349</span> <span class="n">I</span> <span class="o">|</span> <span class="n">etcdserver</span><span class="o">:</span> <span class="n">name</span> <span class="o">=</span> <span class="k">default</span>
<span class="mi">2017</span><span class="o">-</span><span class="mi">12</span><span class="o">-</span><span class="mo">02</span> <span class="mi">08</span><span class="o">:</span><span class="mi">28</span><span class="o">:</span><span class="mf">04.531370</span> <span class="n">I</span> <span class="o">|</span> <span class="n">etcdserver</span><span class="o">:</span> <span class="n">data</span> <span class="n">dir</span> <span class="o">=</span> <span class="k">default</span><span class="p">.</span><span class="n">etcd</span>
<span class="mi">2017</span><span class="o">-</span><span class="mi">12</span><span class="o">-</span><span class="mo">02</span> <span class="mi">08</span><span class="o">:</span><span class="mi">28</span><span class="o">:</span><span class="mf">04.531375</span> <span class="n">I</span> <span class="o">|</span> <span class="n">etcdserver</span><span class="o">:</span> <span class="n">member</span> <span class="n">dir</span> <span class="o">=</span> <span class="k">default</span><span class="p">.</span><span class="n">etcd</span><span class="o">/</span><span class="n">member</span>
<span class="mi">2017</span><span class="o">-</span><span class="mi">12</span><span class="o">-</span><span class="mo">02</span> <span class="mi">08</span><span class="o">:</span><span class="mi">28</span><span class="o">:</span><span class="mf">04.531379</span> <span class="n">I</span> <span class="o">|</span> <span class="n">etcdserver</span><span class="o">:</span> <span class="n">heartbeat</span> <span class="o">=</span> <span class="mi">100</span><span class="n">ms</span>
<span class="mi">2017</span><span class="o">-</span><span class="mi">12</span><span class="o">-</span><span class="mo">02</span> <span class="mi">08</span><span class="o">:</span><span class="mi">28</span><span class="o">:</span><span class="mf">04.531382</span> <span class="n">I</span> <span class="o">|</span> <span class="n">etcdserver</span><span class="o">:</span> <span class="n">election</span> <span class="o">=</span> <span class="mi">1000</span><span class="n">ms</span>
<span class="mi">2017</span><span class="o">-</span><span class="mi">12</span><span class="o">-</span><span class="mo">02</span> <span class="mi">08</span><span class="o">:</span><span class="mi">28</span><span class="o">:</span><span class="mf">04.531385</span> <span class="n">I</span> <span class="o">|</span> <span class="n">etcdserver</span><span class="o">:</span> <span class="n">snapshot</span> <span class="n">count</span> <span class="o">=</span> <span class="mi">10000</span>
<span class="mi">2017</span><span class="o">-</span><span class="mi">12</span><span class="o">-</span><span class="mo">02</span> <span class="mi">08</span><span class="o">:</span><span class="mi">28</span><span class="o">:</span><span class="mf">04.531392</span> <span class="n">I</span> <span class="o">|</span> <span class="n">etcdserver</span><span class="o">:</span> <span class="n">advertise</span> <span class="n">client</span> <span class="n">URLs</span> <span class="o">=</span> <span class="n">http</span><span class="o">:</span><span class="c1">//localhost:2379</span>
<span class="mi">2017</span><span class="o">-</span><span class="mi">12</span><span class="o">-</span><span class="mo">02</span> <span class="mi">08</span><span class="o">:</span><span class="mi">28</span><span class="o">:</span><span class="mf">04.531396</span> <span class="n">I</span> <span class="o">|</span> <span class="n">etcdserver</span><span class="o">:</span> <span class="n">initial</span> <span class="n">advertise</span> <span class="n">peer</span> <span class="n">URLs</span> <span class="o">=</span> <span class="n">http</span><span class="o">:</span><span class="c1">//localhost:2380</span>
<span class="mi">2017</span><span class="o">-</span><span class="mi">12</span><span class="o">-</span><span class="mo">02</span> <span class="mi">08</span><span class="o">:</span><span class="mi">28</span><span class="o">:</span><span class="mf">04.531403</span> <span class="n">I</span> <span class="o">|</span> <span class="n">etcdserver</span><span class="o">:</span> <span class="n">initial</span> <span class="n">cluster</span> <span class="o">=</span> <span class="k">default</span><span class="o">=</span><span class="n">http</span><span class="o">:</span><span class="c1">//localhost:2380</span>
<span class="mi">2017</span><span class="o">-</span><span class="mi">12</span><span class="o">-</span><span class="mo">02</span> <span class="mi">08</span><span class="o">:</span><span class="mi">28</span><span class="o">:</span><span class="mf">04.534043</span> <span class="n">I</span> <span class="o">|</span> <span class="n">etcdserver</span><span class="o">:</span> <span class="n">starting</span> <span class="n">member</span> <span class="mf">8e9</span><span class="n">e05c52164694d</span> <span class="n">in</span> <span class="n">cluster</span> <span class="n">cdf818194e3a8c32</span>
<span class="mi">2017</span><span class="o">-</span><span class="mi">12</span><span class="o">-</span><span class="mo">02</span> <span class="mi">08</span><span class="o">:</span><span class="mi">28</span><span class="o">:</span><span class="mf">04.534068</span> <span class="n">I</span> <span class="o">|</span> <span class="n">raft</span><span class="o">:</span> <span class="mf">8e9</span><span class="n">e05c52164694d</span> <span class="n">became</span> <span class="n">follower</span> <span class="n">at</span> <span class="n">term</span> <span class="mi">0</span>
<span class="mi">2017</span><span class="o">-</span><span class="mi">12</span><span class="o">-</span><span class="mo">02</span> <span class="mi">08</span><span class="o">:</span><span class="mi">28</span><span class="o">:</span><span class="mf">04.534077</span> <span class="n">I</span> <span class="o">|</span> <span class="n">raft</span><span class="o">:</span> <span class="n">newRaft</span> <span class="mf">8e9</span><span class="n">e05c52164694d</span> <span class="p">[</span><span class="n">peers</span><span class="o">:</span> <span class="p">[],</span> <span class="n">term</span><span class="o">:</span> <span class="mi">0</span><span class="p">,</span> <span class="n">commit</span><span class="o">:</span> <span class="mi">0</span><span class="p">,</span> <span class="n">applied</span><span class="o">:</span> <span class="mi">0</span><span class="p">,</span> <span class="n">lastindex</span><span class="o">:</span> <span class="mi">0</span><span class="p">,</span> <span class="n">lastterm</span><span class="o">:</span> <span class="mi">0</span><span class="p">]</span>
<span class="mi">2017</span><span class="o">-</span><span class="mi">12</span><span class="o">-</span><span class="mo">02</span> <span class="mi">08</span><span class="o">:</span><span class="mi">28</span><span class="o">:</span><span class="mf">04.534082</span> <span class="n">I</span> <span class="o">|</span> <span class="n">raft</span><span class="o">:</span> <span class="mf">8e9</span><span class="n">e05c52164694d</span> <span class="n">became</span> <span class="n">follower</span> <span class="n">at</span> <span class="n">term</span> <span class="mi">1</span>
<span class="mi">2017</span><span class="o">-</span><span class="mi">12</span><span class="o">-</span><span class="mo">02</span> <span class="mi">08</span><span class="o">:</span><span class="mi">28</span><span class="o">:</span><span class="mf">04.543383</span> <span class="n">I</span> <span class="o">|</span> <span class="n">etcdserver</span><span class="o">:</span> <span class="n">starting</span> <span class="n">server</span><span class="p">...</span> <span class="p">[</span><span class="n">version</span><span class="o">:</span> <span class="mf">3.1.11</span><span class="p">,</span> <span class="n">cluster</span> <span class="n">version</span><span class="o">:</span> <span class="n">to_be_decided</span><span class="p">]</span>
<span class="mi">2017</span><span class="o">-</span><span class="mi">12</span><span class="o">-</span><span class="mo">02</span> <span class="mi">08</span><span class="o">:</span><span class="mi">28</span><span class="o">:</span><span class="mf">04.544244</span> <span class="n">I</span> <span class="o">|</span> <span class="n">etcdserver</span><span class="o">/</span><span class="n">membership</span><span class="o">:</span> <span class="n">added</span> <span class="n">member</span> <span class="mf">8e9</span><span class="n">e05c52164694d</span> <span class="p">[</span><span class="n">http</span><span class="o">:</span><span class="c1">//localhost:2380] to cluster cdf818194e3a8c32</span>
<span class="mi">2017</span><span class="o">-</span><span class="mi">12</span><span class="o">-</span><span class="mo">02</span> <span class="mi">08</span><span class="o">:</span><span class="mi">28</span><span class="o">:</span><span class="mf">04.734379</span> <span class="n">I</span> <span class="o">|</span> <span class="n">raft</span><span class="o">:</span> <span class="mf">8e9</span><span class="n">e05c52164694d</span> <span class="n">is</span> <span class="n">starting</span> <span class="n">a</span> <span class="n">new</span> <span class="n">election</span> <span class="n">at</span> <span class="n">term</span> <span class="mi">1</span>
<span class="mi">2017</span><span class="o">-</span><span class="mi">12</span><span class="o">-</span><span class="mo">02</span> <span class="mi">08</span><span class="o">:</span><span class="mi">28</span><span class="o">:</span><span class="mf">04.734472</span> <span class="n">I</span> <span class="o">|</span> <span class="n">raft</span><span class="o">:</span> <span class="mf">8e9</span><span class="n">e05c52164694d</span> <span class="n">became</span> <span class="n">candidate</span> <span class="n">at</span> <span class="n">term</span> <span class="mi">2</span>
<span class="mi">2017</span><span class="o">-</span><span class="mi">12</span><span class="o">-</span><span class="mo">02</span> <span class="mi">08</span><span class="o">:</span><span class="mi">28</span><span class="o">:</span><span class="mf">04.734490</span> <span class="n">I</span> <span class="o">|</span> <span class="n">raft</span><span class="o">:</span> <span class="mf">8e9</span><span class="n">e05c52164694d</span> <span class="n">received</span> <span class="n">MsgVoteResp</span> <span class="n">from</span> <span class="mf">8e9</span><span class="n">e05c52164694d</span> <span class="n">at</span> <span class="n">term</span> <span class="mi">2</span>
<span class="mi">2017</span><span class="o">-</span><span class="mi">12</span><span class="o">-</span><span class="mo">02</span> <span class="mi">08</span><span class="o">:</span><span class="mi">28</span><span class="o">:</span><span class="mf">04.734505</span> <span class="n">I</span> <span class="o">|</span> <span class="n">raft</span><span class="o">:</span> <span class="mf">8e9</span><span class="n">e05c52164694d</span> <span class="n">became</span> <span class="n">leader</span> <span class="n">at</span> <span class="n">term</span> <span class="mi">2</span>
<span class="mi">2017</span><span class="o">-</span><span class="mi">12</span><span class="o">-</span><span class="mo">02</span> <span class="mi">08</span><span class="o">:</span><span class="mi">28</span><span class="o">:</span><span class="mf">04.734512</span> <span class="n">I</span> <span class="o">|</span> <span class="n">raft</span><span class="o">:</span> <span class="n">raft</span><span class="p">.</span><span class="n">node</span><span class="o">:</span> <span class="mf">8e9</span><span class="n">e05c52164694d</span> <span class="n">elected</span> <span class="n">leader</span> <span class="mf">8e9</span><span class="n">e05c52164694d</span> <span class="n">at</span> <span class="n">term</span> <span class="mi">2</span>
<span class="mi">2017</span><span class="o">-</span><span class="mi">12</span><span class="o">-</span><span class="mo">02</span> <span class="mi">08</span><span class="o">:</span><span class="mi">28</span><span class="o">:</span><span class="mf">04.735011</span> <span class="n">I</span> <span class="o">|</span> <span class="n">etcdserver</span><span class="o">:</span> <span class="n">setting</span> <span class="n">up</span> <span class="n">the</span> <span class="n">initial</span> <span class="n">cluster</span> <span class="n">version</span> <span class="n">to</span> <span class="mf">3.1</span>
<span class="mi">2017</span><span class="o">-</span><span class="mi">12</span><span class="o">-</span><span class="mo">02</span> <span class="mi">08</span><span class="o">:</span><span class="mi">28</span><span class="o">:</span><span class="mf">04.735063</span> <span class="n">I</span> <span class="o">|</span> <span class="n">etcdserver</span><span class="o">:</span> <span class="n">published</span> <span class="p">{</span><span class="n">Name</span><span class="o">:</span><span class="k">default</span> <span class="n">ClientURLs</span><span class="o">:</span><span class="p">[</span><span class="n">http</span><span class="o">:</span><span class="c1">//localhost:2379]} to cluster cdf818194e3a8c32</span>
<span class="mi">2017</span><span class="o">-</span><span class="mi">12</span><span class="o">-</span><span class="mo">02</span> <span class="mi">08</span><span class="o">:</span><span class="mi">28</span><span class="o">:</span><span class="mf">04.735155</span> <span class="n">E</span> <span class="o">|</span> <span class="n">etcdmain</span><span class="o">:</span> <span class="n">forgot</span> <span class="n">to</span> <span class="n">set</span> <span class="n">Type</span><span class="o">=</span><span class="n">notify</span> <span class="n">in</span> <span class="n">systemd</span> <span class="n">service</span> <span class="n">file</span><span class="o">?</span>
<span class="mi">2017</span><span class="o">-</span><span class="mi">12</span><span class="o">-</span><span class="mo">02</span> <span class="mi">08</span><span class="o">:</span><span class="mi">28</span><span class="o">:</span><span class="mf">04.735163</span> <span class="n">I</span> <span class="o">|</span> <span class="n">embed</span><span class="o">:</span> <span class="n">ready</span> <span class="n">to</span> <span class="n">serve</span> <span class="n">client</span> <span class="n">requests</span>
<span class="mi">2017</span><span class="o">-</span><span class="mi">12</span><span class="o">-</span><span class="mo">02</span> <span class="mi">08</span><span class="o">:</span><span class="mi">28</span><span class="o">:</span><span class="mf">04.735380</span> <span class="n">N</span> <span class="o">|</span> <span class="n">embed</span><span class="o">:</span> <span class="n">serving</span> <span class="n">insecure</span> <span class="n">client</span> <span class="n">requests</span> <span class="n">on</span> <span class="mf">127.0.0.1</span><span class="o">:</span><span class="mi">2379</span><span class="p">,</span> <span class="n">this</span> <span class="n">is</span> <span class="n">strongly</span> <span class="n">discouraged</span><span class="o">!</span>
<span class="mi">2017</span><span class="o">-</span><span class="mi">12</span><span class="o">-</span><span class="mo">02</span> <span class="mi">08</span><span class="o">:</span><span class="mi">28</span><span class="o">:</span><span class="mf">04.737414</span> <span class="n">N</span> <span class="o">|</span> <span class="n">etcdserver</span><span class="o">/</span><span class="n">membership</span><span class="o">:</span> <span class="n">set</span> <span class="n">the</span> <span class="n">initial</span> <span class="n">cluster</span> <span class="n">version</span> <span class="n">to</span> <span class="mf">3.1</span>
<span class="mi">2017</span><span class="o">-</span><span class="mi">12</span><span class="o">-</span><span class="mo">02</span> <span class="mi">08</span><span class="o">:</span><span class="mi">28</span><span class="o">:</span><span class="mf">04.737465</span> <span class="n">I</span> <span class="o">|</span> <span class="n">etcdserver</span><span class="o">/</span><span class="n">api</span><span class="o">:</span> <span class="n">enabled</span> <span class="n">capabilities</span> <span class="k">for</span> <span class="n">version</span> <span class="mf">3.1</span>
</pre></div>


<ul>
<li>可以使用 etcdctl 命令进行测试</li>
<li>说明 etcd 服务已经成功启动了</li>
</ul>
<div class="hlcode"><pre><span class="p">[</span><span class="n">root</span><span class="err">@</span><span class="n">nagios</span> <span class="o">~</span><span class="p">]</span><span class="err">#</span> <span class="n">etcdctl</span>  <span class="n">set</span> <span class="n">testkey</span> <span class="err">&#39;</span><span class="n">helloworld</span><span class="err">&#39;</span>
<span class="n">helloworld</span>
<span class="p">[</span><span class="n">root</span><span class="err">@</span><span class="n">nagios</span> <span class="o">~</span><span class="p">]</span><span class="err">#</span> <span class="n">etcdctl</span> <span class="n">get</span> <span class="n">testkey</span>
<span class="n">helloworld</span>
</pre></div>


<ul>
<li>也可以通过 HTTP 访问本地 2379 或 4001 端口的方式来进行操作，例如查看 testkey 的值：</li>
</ul>
<div class="hlcode"><pre><span class="p">[</span><span class="n">root</span><span class="err">@</span><span class="n">nagios</span> <span class="o">~</span><span class="p">]</span><span class="err">#</span> <span class="n">curl</span> <span class="o">-</span><span class="n">L</span> <span class="n">http</span><span class="o">:</span><span class="c1">//127.0.0.1:2379/v2/keys/testkey</span>
<span class="p">{</span><span class="s">&quot;action&quot;</span><span class="o">:</span><span class="s">&quot;get&quot;</span><span class="p">,</span><span class="s">&quot;node&quot;</span><span class="o">:</span><span class="p">{</span><span class="s">&quot;key&quot;</span><span class="o">:</span><span class="s">&quot;/testkey&quot;</span><span class="p">,</span><span class="s">&quot;value&quot;</span><span class="o">:</span><span class="s">&quot;helloworld&quot;</span><span class="p">,</span><span class="s">&quot;modifiedIndex&quot;</span><span class="o">:</span><span class="mi">4</span><span class="p">,</span><span class="s">&quot;createdIndex&quot;</span><span class="o">:</span><span class="mi">4</span><span class="p">}}</span>
</pre></div>


<h4 id="etcdctl">使用 etcdctl</h4>
<ul>
<li>etcdctl 是一个命令行客户端，它能提供一些简洁的命令，供用户直接跟 etcd 服务打交道，而无需基于 HTTP API 方式。这在某些情况下将很方便，例如用户对服务进行测试或者手动修改数据库内容。我们也推荐在刚接触 etcd 时通过 etcdctl 命令来熟悉相关的操作，这些操作跟 HTTP API 实际上是对应的。</li>
</ul>
<h5 id="_27">数据库操作</h5>
<ul>
<li>数据库操作围绕对键值和目录的 CRUD （符合 REST 风格的一套操作：Create）完整生命周期的管理。<br />
  etcd 在键的组织上采用了层次化的空间结构（类似于文件系统中目录的概念），用户指定的键可以为单独的名字，如 testkey，此时实际上放在根目录 / 下面，也可以为指定目录结构，如 cluster1/node2/testkey，则将创建相应的目录结构。</li>
</ul>
<div class="hlcode"><pre><span class="n">set</span>

<span class="err">指定某个键的值。例如</span>

<span class="err">$</span> <span class="n">etcdctl</span> <span class="n">set</span> <span class="o">/</span><span class="n">testdir</span><span class="o">/</span><span class="n">testkey</span> <span class="s">&quot;Hello world&quot;</span>
<span class="n">Hello</span> <span class="n">world</span>
<span class="err">支持的选项包括：</span>

<span class="o">--</span><span class="n">ttl</span> <span class="sc">&#39;0&#39;</span>            <span class="err">该键值的超时时间（单位为秒），不配置（默认为</span> <span class="mi">0</span><span class="err">）则永不超时</span>
<span class="o">--</span><span class="n">swap</span><span class="o">-</span><span class="n">with</span><span class="o">-</span><span class="n">value</span> <span class="n">value</span> <span class="err">若该键现在的值是</span> <span class="n">value</span><span class="err">，则进行设置操作</span>
<span class="o">--</span><span class="n">swap</span><span class="o">-</span><span class="n">with</span><span class="o">-</span><span class="n">index</span> <span class="sc">&#39;0&#39;</span>    <span class="err">若该键现在的索引值是指定索引，则进行设置操作</span>
<span class="n">get</span>

<span class="err">获取指定键的值。例如</span>

<span class="err">$</span> <span class="n">etcdctl</span> <span class="n">set</span> <span class="n">testkey</span> <span class="n">hello</span>
<span class="n">hello</span>
<span class="err">$</span> <span class="n">etcdctl</span> <span class="n">update</span> <span class="n">testkey</span> <span class="n">world</span>
<span class="n">world</span>
<span class="err">当键不存在时，则会报错。例如</span>

<span class="err">$</span> <span class="n">etcdctl</span> <span class="n">get</span> <span class="n">testkey2</span>
<span class="nl">Error:</span>  <span class="mi">100</span><span class="o">:</span> <span class="n">Key</span> <span class="n">not</span> <span class="n">found</span> <span class="p">(</span><span class="o">/</span><span class="n">testkey2</span><span class="p">)</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="err">支持的选项为</span>

<span class="o">--</span><span class="n">sort</span>    <span class="err">对结果进行排序</span>
<span class="o">--</span><span class="n">consistent</span> <span class="err">将请求发给主节点，保证获取内容的一致性</span>
<span class="n">update</span>

<span class="err">当键存在时，更新值内容。例如</span>

<span class="err">$</span> <span class="n">etcdctl</span> <span class="n">set</span> <span class="n">testkey</span> <span class="n">hello</span>
<span class="n">hello</span>
<span class="err">$</span> <span class="n">etcdctl</span> <span class="n">update</span> <span class="n">testkey</span> <span class="n">world</span>
<span class="n">world</span>
<span class="err">当键不存在时，则会报错。例如</span>

<span class="err">$</span> <span class="n">etcdctl</span> <span class="n">update</span> <span class="n">testkey2</span> <span class="n">world</span>
<span class="nl">Error:</span>  <span class="mi">100</span><span class="o">:</span> <span class="n">Key</span> <span class="n">not</span> <span class="n">found</span> <span class="p">(</span><span class="o">/</span><span class="n">testkey2</span><span class="p">)</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="err">支持的选项为</span>

<span class="o">--</span><span class="n">ttl</span> <span class="sc">&#39;0&#39;</span>    <span class="err">超时时间（单位为秒），不配置（默认为</span> <span class="mi">0</span><span class="err">）则永不超时</span>
<span class="n">rm</span>

<span class="err">删除某个键值。例如</span>

<span class="err">$</span> <span class="n">etcdctl</span> <span class="n">rm</span> <span class="n">testkey</span>
<span class="err">当键不存在时，则会报错。例如</span>

<span class="err">$</span> <span class="n">etcdctl</span> <span class="n">rm</span> <span class="n">testkey2</span>
<span class="nl">Error:</span>  <span class="mi">100</span><span class="o">:</span> <span class="n">Key</span> <span class="n">not</span> <span class="n">found</span> <span class="p">(</span><span class="o">/</span><span class="n">testkey2</span><span class="p">)</span> <span class="p">[</span><span class="mi">8</span><span class="p">]</span>
<span class="err">支持的选项为</span>

<span class="o">--</span><span class="n">dir</span>        <span class="err">如果键是个空目录或者键值对则删除</span>
<span class="o">--</span><span class="n">recursive</span>        <span class="err">删除目录和所有子键</span>
<span class="o">--</span><span class="n">with</span><span class="o">-</span><span class="n">value</span>     <span class="err">检查现有的值是否匹配</span>
<span class="o">--</span><span class="n">with</span><span class="o">-</span><span class="n">index</span> <span class="sc">&#39;0&#39;</span>    <span class="err">检查现有的</span> <span class="n">index</span> <span class="err">是否匹配</span>
<span class="n">mk</span>

<span class="err">如果给定的键不存在，则创建一个新的键值。例如</span>

<span class="err">$</span> <span class="n">etcdctl</span> <span class="n">mk</span> <span class="o">/</span><span class="n">testdir</span><span class="o">/</span><span class="n">testkey</span> <span class="s">&quot;Hello world&quot;</span>
<span class="n">Hello</span> <span class="n">world</span>
<span class="err">当键存在的时候，执行该命令会报错，例如</span>

<span class="err">$</span> <span class="n">etcdctl</span> <span class="n">set</span> <span class="n">testkey</span> <span class="s">&quot;Hello world&quot;</span>
<span class="n">Hello</span> <span class="n">world</span>
<span class="err">$</span> <span class="p">.</span><span class="o">/</span><span class="n">etcdctl</span> <span class="n">mk</span> <span class="n">testkey</span> <span class="s">&quot;Hello world&quot;</span>
<span class="nl">Error:</span>  <span class="mi">105</span><span class="o">:</span> <span class="n">Key</span> <span class="n">already</span> <span class="n">exists</span> <span class="p">(</span><span class="o">/</span><span class="n">testkey</span><span class="p">)</span> <span class="p">[</span><span class="mi">2</span><span class="p">]</span>
<span class="err">支持的选项为</span>

<span class="o">--</span><span class="n">ttl</span> <span class="sc">&#39;0&#39;</span>    <span class="err">超时时间（单位为秒），不配置（默认为</span> <span class="mi">0</span><span class="err">）则永不超时</span>
<span class="n">mkdir</span>

<span class="err">如果给定的键目录不存在，则创建一个新的键目录。例如</span>

<span class="err">$</span> <span class="n">etcdctl</span> <span class="n">mkdir</span> <span class="n">testdir</span>
<span class="err">当键目录存在的时候，执行该命令会报错，例如</span>

<span class="err">$</span> <span class="n">etcdctl</span> <span class="n">mkdir</span> <span class="n">testdir</span>
<span class="err">$</span> <span class="n">etcdctl</span> <span class="n">mkdir</span> <span class="n">testdir</span>
<span class="nl">Error:</span>  <span class="mi">105</span><span class="o">:</span> <span class="n">Key</span> <span class="n">already</span> <span class="n">exists</span> <span class="p">(</span><span class="o">/</span><span class="n">testdir</span><span class="p">)</span> <span class="p">[</span><span class="mi">7</span><span class="p">]</span>
<span class="err">支持的选项为</span>

<span class="o">--</span><span class="n">ttl</span> <span class="sc">&#39;0&#39;</span>    <span class="err">超时时间（单位为秒），不配置（默认为</span> <span class="mi">0</span><span class="err">）则永不超时</span>
<span class="n">setdir</span>

<span class="err">创建一个键目录，无论存在与否。</span>

<span class="err">支持的选项为</span>

<span class="o">--</span><span class="n">ttl</span> <span class="sc">&#39;0&#39;</span>    <span class="err">超时时间（单位为秒），不配置（默认为</span> <span class="mi">0</span><span class="err">）则永不超时</span>
<span class="n">updatedir</span>

<span class="err">更新一个已经存在的目录。</span> <span class="err">支持的选项为</span>

<span class="o">--</span><span class="n">ttl</span> <span class="sc">&#39;0&#39;</span>    <span class="err">超时时间（单位为秒），不配置（默认为</span> <span class="mi">0</span><span class="err">）则永不超时</span>
<span class="n">rmdir</span>

<span class="err">删除一个空目录，或者键值对。</span>

<span class="err">若目录不空，会报错</span>

<span class="err">$</span> <span class="n">etcdctl</span> <span class="n">set</span> <span class="o">/</span><span class="n">dir</span><span class="o">/</span><span class="n">testkey</span> <span class="n">hi</span>
<span class="n">hi</span>
<span class="err">$</span> <span class="n">etcdctl</span> <span class="n">rmdir</span> <span class="o">/</span><span class="n">dir</span>
<span class="nl">Error:</span>  <span class="mi">108</span><span class="o">:</span> <span class="n">Directory</span> <span class="n">not</span> <span class="n">empty</span> <span class="p">(</span><span class="o">/</span><span class="n">dir</span><span class="p">)</span> <span class="p">[</span><span class="mi">13</span><span class="p">]</span>
<span class="n">ls</span>

<span class="err">列出目录（默认为根目录）下的键或者子目录，默认不显示子目录中内容。</span>

<span class="err">例如</span>

<span class="err">$</span> <span class="p">.</span><span class="o">/</span><span class="n">etcdctl</span> <span class="n">set</span> <span class="n">testkey</span> <span class="err">&#39;</span><span class="n">hi</span><span class="err">&#39;</span>
<span class="n">hi</span>
<span class="err">$</span> <span class="p">.</span><span class="o">/</span><span class="n">etcdctl</span> <span class="n">set</span> <span class="n">dir</span><span class="o">/</span><span class="n">test</span> <span class="err">&#39;</span><span class="n">hello</span><span class="err">&#39;</span>
<span class="n">hello</span>
<span class="err">$</span> <span class="p">.</span><span class="o">/</span><span class="n">etcdctl</span> <span class="n">ls</span>
<span class="o">/</span><span class="n">testkey</span>
<span class="o">/</span><span class="n">dir</span>
<span class="err">$</span> <span class="p">.</span><span class="o">/</span><span class="n">etcdctl</span> <span class="n">ls</span> <span class="n">dir</span>
<span class="o">/</span><span class="n">dir</span><span class="o">/</span><span class="n">test</span>
<span class="err">支持的选项包括</span>

<span class="o">--</span><span class="n">sort</span>    <span class="err">将输出结果排序</span>
<span class="o">--</span><span class="n">recursive</span>    <span class="err">如果目录下有子目录，则递归输出其中的内容</span>
<span class="o">-</span><span class="n">p</span>        <span class="err">对于输出为目录，在最后添加</span> <span class="err">`</span><span class="o">/</span><span class="err">`</span> <span class="err">进行区分</span>
</pre></div>


<h5 id="_28">非数据库操作</h5>
<div class="hlcode"><pre><span class="n">backup</span>

<span class="err">备份</span> <span class="n">etcd</span> <span class="err">的数据。</span>

<span class="err">支持的选项包括</span>

<span class="o">--</span><span class="n">data</span><span class="o">-</span><span class="n">dir</span>         <span class="n">etcd</span> <span class="err">的数据目录</span>
<span class="o">--</span><span class="n">backup</span><span class="o">-</span><span class="n">dir</span>     <span class="err">备份到指定路径</span>
<span class="n">watch</span>

<span class="err">监测一个键值的变化，一旦键值发生更新，就会输出最新的值并退出。</span>

<span class="err">例如，用户更新</span> <span class="n">testkey</span> <span class="err">键值为</span> <span class="n">Hello</span> <span class="n">world</span><span class="err">。</span>

<span class="err">$</span> <span class="n">etcdctl</span> <span class="n">watch</span> <span class="n">testkey</span>
<span class="n">Hello</span> <span class="n">world</span>
<span class="err">支持的选项包括</span>

<span class="o">--</span><span class="n">forever</span>        <span class="err">一直监测，直到用户按</span> <span class="err">`</span><span class="n">CTRL</span><span class="o">+</span><span class="n">C</span><span class="err">`</span> <span class="err">退出</span>
<span class="o">--</span><span class="n">after</span><span class="o">-</span><span class="n">index</span> <span class="sc">&#39;0&#39;</span>    <span class="err">在指定</span> <span class="n">index</span> <span class="err">之前一直监测</span>
<span class="o">--</span><span class="n">recursive</span>        <span class="err">返回所有的键值和子键值</span>
<span class="n">exec</span><span class="o">-</span><span class="n">watch</span>

<span class="err">监测一个键值的变化，一旦键值发生更新，就执行给定命令。</span>

<span class="err">例如，用户更新</span> <span class="n">testkey</span> <span class="err">键值。</span>

<span class="err">$</span><span class="n">etcdctl</span> <span class="n">exec</span><span class="o">-</span><span class="n">watch</span> <span class="n">testkey</span> <span class="o">--</span> <span class="n">sh</span> <span class="o">-</span><span class="n">c</span> <span class="err">&#39;</span><span class="n">ls</span><span class="err">&#39;</span>
<span class="k">default</span><span class="p">.</span><span class="n">etcd</span>
<span class="n">Documentation</span>
<span class="n">etcd</span>
<span class="n">etcdctl</span>
<span class="n">etcd</span><span class="o">-</span><span class="n">migrate</span>
<span class="n">README</span><span class="o">-</span><span class="n">etcdctl</span><span class="p">.</span><span class="n">md</span>
<span class="n">README</span><span class="p">.</span><span class="n">md</span>
<span class="err">支持的选项包括</span>

<span class="o">--</span><span class="n">after</span><span class="o">-</span><span class="n">index</span> <span class="sc">&#39;0&#39;</span>    <span class="err">在指定</span> <span class="n">index</span> <span class="err">之前一直监测</span>
<span class="o">--</span><span class="n">recursive</span>        <span class="err">返回所有的键值和子键值</span>
<span class="n">member</span>

<span class="err">通过</span> <span class="n">list</span><span class="err">、</span><span class="n">add</span><span class="err">、</span><span class="n">remove</span> <span class="err">命令列出、添加、删除</span> <span class="n">etcd</span> <span class="err">实例到</span> <span class="n">etcd</span> <span class="err">集群中。</span>

<span class="err">例如本地启动一个</span> <span class="n">etcd</span> <span class="err">服务实例后，可以用如下命令进行查看。</span>

<span class="err">$</span> <span class="n">etcdctl</span> <span class="n">member</span> <span class="n">list</span>
<span class="nl">ce2a822cea30bfca:</span> <span class="n">name</span><span class="o">=</span><span class="k">default</span> <span class="n">peerURLs</span><span class="o">=</span><span class="n">http</span><span class="o">:</span><span class="c1">//localhost:2380,http://localhost:7001 clientURLs=http://localhost:2379,http://localhost:4001</span>
</pre></div>


<h5 id="_29">命令选项</h5>
<div class="hlcode"><pre><span class="o">--</span><span class="n">debug</span> <span class="err">输出</span> <span class="n">cURL</span> <span class="err">命令，显示执行命令的时候发起的请求</span>
<span class="o">--</span><span class="n">no</span><span class="o">-</span><span class="n">sync</span> <span class="err">发出请求之前不同步集群信息</span>
<span class="o">--</span><span class="n">output</span><span class="p">,</span> <span class="o">-</span><span class="n">o</span> <span class="err">&#39;</span><span class="n">simple</span><span class="err">&#39;</span> <span class="err">输出内容的格式</span> <span class="p">(</span><span class="n">simple</span> <span class="err">为原始信息，</span><span class="n">json</span> <span class="err">为进行</span><span class="n">json</span><span class="err">格式解码，易读性好一些</span><span class="p">)</span>
<span class="o">--</span><span class="n">peers</span><span class="p">,</span> <span class="o">-</span><span class="n">C</span> <span class="err">指定集群中的同伴信息，用逗号隔开</span> <span class="p">(</span><span class="err">默认为</span><span class="o">:</span> <span class="s">&quot;127.0.0.1:4001&quot;</span><span class="p">)</span>
<span class="o">--</span><span class="n">cert</span><span class="o">-</span><span class="n">file</span> <span class="n">HTTPS</span> <span class="err">下客户端使用的</span> <span class="n">SSL</span> <span class="err">证书文件</span>
<span class="o">--</span><span class="n">key</span><span class="o">-</span><span class="n">file</span> <span class="n">HTTPS</span> <span class="err">下客户端使用的</span> <span class="n">SSL</span> <span class="err">密钥文件</span>
<span class="o">--</span><span class="n">ca</span><span class="o">-</span><span class="n">file</span> <span class="err">服务端使用</span> <span class="n">HTTPS</span> <span class="err">时，使用</span> <span class="n">CA</span> <span class="err">文件进行验证</span>
<span class="o">--</span><span class="n">help</span><span class="p">,</span> <span class="o">-</span><span class="n">h</span> <span class="err">显示帮助命令信息</span>
<span class="o">--</span><span class="n">version</span><span class="p">,</span> <span class="o">-</span><span class="n">v</span> <span class="err">打印版本信息</span>
</pre></div>


<h2 id="coreos">CoreOS</h2>
<ul>
<li>CoreOS 的设计是为你提供能够像谷歌一样的大型互联网公司一样的基础设施管理能力来动态扩展和管理的计算能力。<br />
  CoreOS 的安装文件和运行依赖非常小,它提供了精简的 Linux 系统。它使用 Linux 容器在更高的抽象层来管理你的服务，而不是通过常规的 YUM 和 APT 来安装包。</li>
</ul>
<h3 id="coreos_1">CoreOS 特性</h3>
<div class="hlcode"><pre><span class="err">一个最小化操作系统</span>

<span class="n">CoreOS</span> <span class="err">被设计成一个基于容器的最小化的现代操作系统。它比现有的</span> <span class="n">Linux</span> <span class="err">安装平均节省</span> <span class="mi">40</span><span class="o">%</span> <span class="err">的</span> <span class="n">RAM</span><span class="err">（大约</span> <span class="mi">114</span><span class="n">M</span> <span class="err">）并允许从</span> <span class="n">PXE</span> <span class="err">或</span> <span class="n">iPXE</span> <span class="err">非常快速的启动。</span>

<span class="err">无痛更新</span>

<span class="err">利用主动和被动双分区方案来更新</span> <span class="n">OS</span><span class="err">，使用分区作为一个单元而不是一个包一个包的更新。这使得每次更新变得快速，可靠，而且很容易回滚。</span>

<span class="n">Docker</span><span class="err">容器</span>

<span class="err">应用作为</span> <span class="n">Docker</span> <span class="err">容器运行在</span> <span class="n">CoreOS</span> <span class="err">上。容器以包的形式提供最大得灵活性并且可以在几毫秒启动。</span>

<span class="err">支持集群</span>

<span class="n">CoreOS</span> <span class="err">可以在一个机器上很好地运行，但是它被设计用来搭建集群。</span>

<span class="err">可以通过</span> <span class="n">k8s</span> <span class="err">很容易得使应用容器部署在多台机器上并且通过服务发现把他们连接在一起。</span>

<span class="err">分布式系统工具</span>

<span class="err">内置诸如分布式锁和主选举等原生工具用来构建大规模分布式系统得构建模块。</span>

<span class="err">服务发现</span>

<span class="err">很容易定位服务在集群的那里运行并当发生变化时进行通知。它是复杂高动态集群必不可少的。在</span> <span class="n">CoreOS</span> <span class="err">中构建高可用和自动故障负载。</span>
</pre></div>


<h3 id="coreos_2">CoreOS 工具介绍</h3>
<h4 id="_30">服务发现</h4>
<ul>
<li>
<p>CoreOS 的第一个重要组件就是使用 etcd 来实现的服务发现。</p>
</li>
<li>
<p>配置文件里有一个 token，你可以通过访问 https://discovery.etcd.io/new 来获取一个包含你 teoken 的 URL。</p>
</li>
</ul>
<div class="hlcode"><pre><span class="vi">#cloud</span><span class="na">-config</span>

<span class="nb">hostname</span><span class="p">:</span> <span class="nx">coreos0</span>
<span class="nx">ssh_authorized_keys</span><span class="p">:</span>
  <span class="o">-</span> <span class="nx">ssh</span><span class="na">-rsa</span> <span class="nx">AAAA...</span>
<span class="nx">coreos</span><span class="p">:</span>
  <span class="nx">units</span><span class="p">:</span>
    <span class="o">-</span> <span class="nb">name</span><span class="p">:</span> <span class="nx">etcd.service</span>
      <span class="nb">command</span><span class="p">:</span> <span class="nb">start</span>
    <span class="o">-</span> <span class="nb">name</span><span class="p">:</span> <span class="nx">fleet.service</span>
      <span class="nb">command</span><span class="p">:</span> <span class="nb">start</span>
  <span class="nx">etcd</span><span class="p">:</span>
    <span class="nb">name</span><span class="p">:</span> <span class="nx">coreos0</span>
    <span class="nx">discovery</span><span class="p">:</span> <span class="nx">https</span><span class="p">:</span><span class="c1">//discovery.etcd.io/&lt;token&gt;</span>
</pre></div>


<h4 id="_31">容器管理</h4>
<ul>
<li>第二个组件就是 Docker，它用来运行你的代码和应用。CoreOS 内置 Docker</li>
</ul>
<h3 id="coreos_3">快速搭建 CoreOS 集群</h3>
<h2 id="kubernetes">Kubernetes</h2>
<ul>
<li>建于 Docker 之上的 Kubernetes 可以构建一个容器的调度服务，其目的是让用户透过 Kubernetes 集群来进行云端容器集群的管理，而无需用户进行复杂的设置工作。系统会自动选取合适的工作节点来执行具体的容器集群调度处理工作。其核心概念是 Container Pod。一个 Pod 由一组工作于同一物理工作节点的容器构成。这些组容器拥有相同的网络命名空间、IP以及存储配额，也可以根据实际情况对每一个 Pod 进行端口映射。此外，Kubernetes 工作节点会由主系统进行管理，节点包含了能够运行 Docker 容器所用到的服务。</li>
</ul>
<h3 id="_32">项目简介</h3>
<ul>
<li>Kubernetes 是 Google 团队发起的开源项目，它的目标是管理跨多个主机的容器，提供基本的部署，维护以及运用伸缩，主要实现语言为 Go 语言。</li>
</ul>
<h4 id="_33">快速上手</h4>
<ul>
<li>Kubernetes 依赖 Etcd 服务来维护所有主节点的状态。 </li>
</ul>
<h5 id="etcd_2">启动 Etcd 服务</h5>
<div class="hlcode"><pre><span class="n">docker</span> <span class="n">run</span> <span class="o">--</span><span class="n">net</span><span class="o">=</span><span class="n">host</span> <span class="o">-</span><span class="n">d</span> <span class="n">gcr</span><span class="p">.</span><span class="n">io</span><span class="o">/</span><span class="n">google_containers</span><span class="o">/</span><span class="n">etcd</span><span class="o">:</span><span class="mf">3.1.10</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="n">bin</span><span class="o">/</span><span class="n">etcd</span> <span class="o">--</span><span class="n">addr</span><span class="o">=</span><span class="mf">127.0.0.1</span><span class="o">:</span><span class="mi">4001</span> <span class="o">--</span><span class="n">bind</span><span class="o">-</span><span class="n">addr</span><span class="o">=</span><span class="mf">0.0.0.0</span><span class="o">:</span><span class="mi">4001</span> <span class="o">--</span><span class="n">data</span><span class="o">-</span><span class="n">dir</span><span class="o">=/</span><span class="n">var</span><span class="o">/</span><span class="n">etcd</span><span class="o">/</span><span class="n">data</span>
</pre></div>


<h5 id="_34">启动主节点</h5>
<div class="hlcode"><pre><span class="n">docker</span> <span class="n">run</span> <span class="o">--</span><span class="n">net</span><span class="o">=</span><span class="n">host</span> <span class="o">-</span><span class="n">d</span> <span class="o">-</span><span class="n">v</span> <span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">run</span><span class="o">/</span><span class="n">docker</span><span class="p">.</span><span class="n">sock</span><span class="o">:/</span><span class="n">var</span><span class="o">/</span><span class="n">run</span><span class="o">/</span><span class="n">docker</span><span class="p">.</span><span class="n">sock</span>  <span class="n">gcr</span><span class="p">.</span><span class="n">io</span><span class="o">/</span><span class="n">google_containers</span><span class="o">/</span><span class="n">hyperkube</span><span class="o">:</span><span class="n">v1</span><span class="mf">.17.11</span> <span class="o">/</span><span class="n">hyperkube</span> <span class="n">kubelet</span> <span class="o">--</span><span class="n">api_servers</span><span class="o">=</span><span class="n">http</span><span class="o">:</span><span class="c1">//localhost:8080 --v=2 --address=0.0.0.0 --enable_server --hostname_override=127.0.0.1 --config=/etc/kubernetes/manifests</span>
</pre></div>


<h5 id="_35">启动服务代理</h5>
<div class="hlcode"><pre><span class="n">docker</span> <span class="n">run</span> <span class="o">-</span><span class="n">d</span> <span class="o">--</span><span class="n">net</span><span class="o">=</span><span class="n">host</span> <span class="o">--</span><span class="n">privileged</span> <span class="n">gcr</span><span class="p">.</span><span class="n">io</span><span class="o">/</span><span class="n">google_containers</span><span class="o">/</span><span class="n">hyperkube</span><span class="o">:</span><span class="n">v1</span><span class="mf">.17.11</span> <span class="o">/</span><span class="n">hyperkube</span> <span class="n">proxy</span> <span class="o">--</span><span class="n">master</span><span class="o">=</span><span class="n">http</span><span class="o">:</span><span class="c1">//127.0.0.1:8080 --v=2</span>
</pre></div>


<h5 id="_36">测试状态</h5>
<div class="hlcode"><pre><span class="err">$</span> <span class="nt">curl</span> <span class="nt">127</span><span class="nc">.0.0.1</span><span class="nd">:8080</span>
<span class="p">{</span>
  <span class="s2">&quot;paths&quot;</span><span class="o">:</span> <span class="cp">[</span>
    <span class="s2">&quot;/api&quot;</span><span class="p">,</span>
    <span class="s2">&quot;/api/v1beta1&quot;</span><span class="p">,</span>
    <span class="s2">&quot;/api/v1beta2&quot;</span><span class="p">,</span>
    <span class="s2">&quot;/api/v1beta3&quot;</span><span class="p">,</span>
    <span class="s2">&quot;/healthz&quot;</span><span class="p">,</span>
    <span class="s2">&quot;/healthz/ping&quot;</span><span class="p">,</span>
    <span class="s2">&quot;/logs/&quot;</span><span class="p">,</span>
    <span class="s2">&quot;/metrics&quot;</span><span class="p">,</span>
    <span class="s2">&quot;/static/&quot;</span><span class="p">,</span>
    <span class="s2">&quot;/swagger-ui/&quot;</span><span class="p">,</span>
    <span class="s2">&quot;/swaggerapi/&quot;</span><span class="p">,</span>
    <span class="s2">&quot;/validate&quot;</span><span class="p">,</span>
    <span class="s2">&quot;/version&quot;</span>
  <span class="cp">]</span>
<span class="p">}</span>
</pre></div>
    </div>
    <div id="footer">
      <span>
        <p>Copyright © 2019 Xu XueHua.
        Powered by <a href="http://simiki.org/" target="_blank">Simiki</a>.</p>
        <p>Site Generated 2019-04-15 15:27:01</p>
      </span>
    </div>

    
    
  </body>
</html>
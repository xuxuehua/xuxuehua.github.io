<!DOCTYPE HTML>
<html>
  <head>
    <link rel="Stylesheet" type="text/css" href="/static/css/style.css">
    <link rel="Stylesheet" type="text/css" href="/static/css/tango.css">
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <link rel="alternate" type="application/atom+xml" href="atom.xml" title="Atom feed">
    <title>kubectl - Xu XueHua</title>
    <meta name="keywords" content="Xu XueHua"/>
    <meta name="description" content="Xu XueHua's public notes"/>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  </head>

  <body>
    <div id="container">
      
<div id="header">
  <div class="post-nav"><a href="/">Home</a>&nbsp;&#187;&nbsp;<a href="/#Kubernetes">Kubernetes</a>&nbsp;&#187;&nbsp;kubectl
    <span class="updated">Page Updated&nbsp;
      2019-02-22 22:32
    </span></div>
</div>
<div class="clearfix"></div>

<div class="page_title">kubectl</div>

  <div class="toc"><span class="toctitle">Table of Contents</span><ul>
<li><a href="#kubectl">kubectl</a><ul>
<li><a href="#syntax">syntax</a></li>
<li><a href="#installation">installation</a><ul>
<li><a href="#mac-osx">mac osx</a><ul>
<li><a href="#binary">binary</a></li>
<li><a href="#brew">brew</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#minikube">minikube</a><ul>
<li><a href="#mac-osx_1">mac osx</a></li>
</ul>
</li>
<li><a href="#_1">基础命令</a><ul>
<li><a href="#create">create 创建资源</a></li>
<li><a href="#delete">delete 删除</a><ul>
<li><a href="#-all">--all</a></li>
<li><a href="#-f">-f 指定配置</a></li>
<li><a href="#-grace-period">--grace-period</a></li>
</ul>
</li>
<li><a href="#edit">edit 编辑资源</a></li>
<li><a href="#explain">explain 资源文档</a></li>
<li><a href="#expose">expose 暴露服务</a></li>
<li><a href="#get">get 显示资源</a><ul>
<li><a href="#controllerrevision-controller">controllerrevision 记录Controller版本</a></li>
<li><a href="#-l">-l 标签选择器</a><ul>
<li><a href="#_2">等值关系</a></li>
<li><a href="#_3">集合关系</a></li>
</ul>
</li>
<li><a href="#-l_1">-L 标签列表</a></li>
<li><a href="#-o">-o 输出</a><ul>
<li><a href="#yaml">yaml</a></li>
<li><a href="#json">json</a></li>
<li><a href="#wide">wide 额外信息</a></li>
<li><a href="#name">name 名称</a></li>
<li><a href="#go-template-go">go-template go 模版</a></li>
<li><a href="#custom-columns">custom-columns 自定义输出</a></li>
<li><a href="#nodes">nodes</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#run">run 运行</a></li>
<li><a href="#set">set 设置属性</a><ul>
<li><a href="#image">image</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_4">部署命令</a><ul>
<li><a href="#autoscale">autoscale 自动伸缩</a></li>
<li><a href="#scale">scale 扩容/缩容</a></li>
<li><a href="#rollout">rollout 滚动更新</a><ul>
<li><a href="#history">history</a></li>
<li><a href="#pause">pause</a></li>
<li><a href="#resume">resume</a></li>
<li><a href="#status">status</a></li>
<li><a href="#undo">undo</a></li>
</ul>
</li>
<li><a href="#rolling-update">rolling-update 滚动升级</a></li>
</ul>
</li>
<li><a href="#_5">集群管理</a><ul>
<li><a href="#certificate">certificate 数字证书</a></li>
<li><a href="#cluster-info">cluster-info 集群信息</a></li>
<li><a href="#cordon">cordon 不可用状态</a></li>
<li><a href="#drain">drain 维护模式</a></li>
<li><a href="#top">top 使用率</a></li>
<li><a href="#taint">taint 声明污点</a></li>
<li><a href="#uncordon">uncordon 可用状态</a></li>
</ul>
</li>
<li><a href="#_6">排错调试</a><ul>
<li><a href="#attach">attach 附加终端</a></li>
<li><a href="#auth">auth 授权信息</a></li>
<li><a href="#cp">cp 复制</a></li>
<li><a href="#exec">exec 执行命令</a><ul>
<li><a href="#-it-shell">-it 交互Shell</a></li>
</ul>
</li>
<li><a href="#describe">describe 详细信息</a><ul>
<li><a href="#pod">pod</a></li>
<li><a href="#servicesvc">service/svc</a></li>
</ul>
</li>
<li><a href="#loglogs">log/logs 日志</a><ul>
<li><a href="#-c">-c 指定容器名称</a></li>
</ul>
</li>
<li><a href="#port-forward">port-forward 端口转发</a></li>
<li><a href="#proxy-api-server">proxy API Server代理</a></li>
</ul>
</li>
<li><a href="#_7">高级命令</a><ul>
<li><a href="#apply">apply 实现声明</a></li>
<li><a href="#convert-api">convert API转换</a></li>
<li><a href="#patch">patch 补丁更新</a></li>
<li><a href="#replace">replace 替换资源</a></li>
</ul>
</li>
<li><a href="#_8">设置命令</a><ul>
<li><a href="#annotate">annotate 资源注释</a></li>
<li><a href="#completion">completion 补全码</a></li>
<li><a href="#label">label 资源标签</a><ul>
<li><a href="#_9">添加标签</a></li>
<li><a href="#-overwrite">覆盖标签 --overwrite</a></li>
<li><a href="#nodes_1">nodes</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_10">其他命令</a><ul>
<li><a href="#api-versions-api">api-versions API版本信息</a></li>
<li><a href="#config">config 配置内容</a></li>
<li><a href="#help">help 帮助</a></li>
<li><a href="#option">option 通用选项</a><ul>
<li><a href="#-s-server-api-server">-s / --server 指定API Server</a></li>
<li><a href="#-kubeconfig">--kubeconfig 文件路径</a></li>
<li><a href="#-namespace">--namespace 名称空间</a></li>
</ul>
</li>
<li><a href="#plugin">plugin 命令行插件</a></li>
<li><a href="#version">version 版本信息</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<h1 id="kubectl">kubectl</h1>
<p>Kubernetes API Server最常用的客户端程序之一，功能强大，能够几乎完成除了安装部署之外的所有管理操作</p>
<p>连接API Server 对K8s相关对象资源的增删改查</p>
<h2 id="syntax">syntax</h2>
<div class="hlcode"><pre><span class="n">kubectl</span> <span class="p">[</span><span class="n">command</span><span class="p">]</span> <span class="p">[</span><span class="n">TYPE</span><span class="p">]</span> <span class="p">[</span><span class="n">NAME</span><span class="p">]</span> <span class="p">[</span><span class="n">flags</span><span class="p">]</span>
</pre></div>


<h2 id="installation">installation</h2>
<h3 id="mac-osx">mac osx</h3>
<h4 id="binary">binary</h4>
<p>Download the latest release:</p>
<div class="hlcode"><pre><span class="n">curl</span> <span class="o">-</span><span class="n">LO</span> <span class="n">https</span><span class="o">:</span><span class="c1">//storage.googleapis.com/kubernetes-release/release/$(curl -s https://storage.googleapis.com/kubernetes-release/release/stable.txt)/bin/darwin/amd64/kubectl</span>
</pre></div>


<p>Make the kubectl binary executable.</p>
<div class="hlcode"><pre><span class="n">chmod</span> <span class="o">+</span><span class="n">x</span> <span class="p">.</span><span class="o">/</span><span class="n">kubectl</span>
</pre></div>


<p>Move the binary in to your PATH.</p>
<div class="hlcode"><pre><span class="n">sudo</span> <span class="n">mv</span> <span class="p">.</span><span class="o">/</span><span class="n">kubectl</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="n">bin</span><span class="o">/</span><span class="n">kubectl</span>
</pre></div>


<h4 id="brew">brew</h4>
<div class="hlcode"><pre><span class="n">brew</span> <span class="n">install</span> <span class="n">kubernetes</span><span class="o">-</span><span class="n">cli</span>
</pre></div>


<h2 id="minikube">minikube</h2>
<h3 id="mac-osx_1">mac osx</h3>
<div class="hlcode"><pre><span class="n">curl</span> <span class="o">-</span><span class="n">Lo</span> <span class="n">minikube</span> <span class="n">https</span><span class="o">:</span><span class="c1">//storage.googleapis.com/minikube/releases/v0.34.1/minikube-darwin-amd64 &amp;&amp; chmod +x minikube &amp;&amp; sudo cp minikube /usr/local/bin/ &amp;&amp; rm minikube</span>
</pre></div>


<h2 id="_1">基础命令</h2>
<h3 id="create">create 创建资源</h3>
<p>通过文件或标准输入创建资源</p>
<div class="hlcode"><pre><span class="n">kubectl</span> <span class="n">create</span> <span class="o">-</span><span class="n">f</span> <span class="n">nignx</span><span class="o">-</span><span class="n">deploy</span><span class="p">.</span><span class="n">yaml</span> <span class="o">-</span><span class="n">f</span> <span class="n">nginx</span><span class="o">-</span><span class="n">svc</span><span class="p">.</span><span class="n">yaml</span>
</pre></div>


<h3 id="delete">delete 删除</h3>
<p>基于文件名，stdin，资源或名字，以及资源和选择器删除资源</p>
<p>删除默认名称空间中ngnix-svc的Service 资源对象 </p>
<div class="hlcode"><pre><span class="n">kubectl</span> <span class="n">delete</span> <span class="n">services</span> <span class="n">nginx</span><span class="o">-</span><span class="n">svc</span>
</pre></div>


<p>删除默认名称空间中所有的Deployment控制器</p>
<div class="hlcode"><pre><span class="n">kubectl</span> <span class="n">delete</span> <span class="n">deployment</span> <span class="o">--</span><span class="n">all</span>
</pre></div>


<h4 id="-all">--all</h4>
<p>删除kube-public 名称空间中的所有pod对象</p>
<div class="hlcode"><pre><span class="n">kubectl</span> <span class="n">delete</span> <span class="n">pods</span> <span class="o">--</span><span class="n">all</span> <span class="o">-</span><span class="n">n</span> <span class="n">kube</span><span class="o">-</span><span class="n">public</span>
</pre></div>


<p>删除所有名称空间的所有资源</p>
<div class="hlcode"><pre><span class="n">kubectl</span> <span class="n">delete</span> <span class="n">all</span> <span class="o">--</span><span class="n">all</span>
</pre></div>


<h4 id="-f">-f 指定配置</h4>
<div class="hlcode"><pre><span class="n">kubectl</span> <span class="n">delete</span> <span class="o">-</span><span class="n">f</span> <span class="n">pod</span><span class="o">-</span><span class="n">example</span><span class="p">.</span><span class="n">yaml</span>
</pre></div>


<h4 id="-grace-period">--grace-period</h4>
<p>默认删除操作为30s，使用此参数自定义其时常</p>
<p>若使用0表示直接强制删除指定的资源，需同时使用<code>--force</code> 选项</p>
<h3 id="edit">edit 编辑资源</h3>
<h3 id="explain">explain 资源文档</h3>
<p>获取相关帮助</p>
<p>解释Pod资源的一级字段</p>
<div class="hlcode"><pre><span class="n">kubectl</span> <span class="n">explain</span> <span class="n">pods</span>
</pre></div>


<p>某对象下的二级字段, 三四级依此类推</p>
<div class="hlcode"><pre><span class="n">kubectl</span> <span class="n">explain</span> <span class="n">pods</span><span class="p">.</span><span class="n">spec</span>
</pre></div>


<h3 id="expose">expose 暴露服务</h3>
<p>基于rc，service，deployment或pod创建Service资源</p>
<div class="hlcode"><pre><span class="n">kubectl</span> <span class="n">expose</span> <span class="p">(</span><span class="o">-</span><span class="n">f</span> <span class="n">FILENAME</span> <span class="o">|</span> <span class="n">TYPE</span> <span class="n">NAME</span><span class="p">)</span> <span class="p">[</span><span class="o">--</span><span class="n">port</span><span class="o">=</span><span class="n">port</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">protocol</span><span class="o">=</span><span class="n">TCP</span><span class="o">|</span><span class="n">UDP</span><span class="o">|</span><span class="n">SCTP</span><span class="p">]</span>
<span class="p">[</span><span class="o">--</span><span class="n">target</span><span class="o">-</span><span class="n">port</span><span class="o">=</span><span class="n">number</span><span class="o">-</span><span class="n">or</span><span class="o">-</span><span class="n">name</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">external</span><span class="o">-</span><span class="n">ip</span><span class="o">=</span><span class="n">external</span><span class="o">-</span><span class="n">ip</span><span class="o">-</span><span class="n">of</span><span class="o">-</span><span class="n">service</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">type</span><span class="o">=</span><span class="n">type</span><span class="p">]</span>
<span class="p">[</span><span class="n">options</span><span class="p">]</span>
</pre></div>


<blockquote>
<p>--port指service 端口， 一般使用众所周知的端口</p>
<p>--target-port指pod端口</p>
<p>两个端口可以一样</p>
</blockquote>
<div class="hlcode"><pre><span class="cp">[</span><span class="nb">root</span><span class="p">@</span><span class="nx">master</span> <span class="err">~</span><span class="cp">]</span># kubectl expose deployment nginx-deploy --name=nginx --port=80 --target-port=80 --protocol=TCP
service/nginx exposed
<span class="cp">[</span><span class="nb">root</span><span class="p">@</span><span class="nx">master</span> <span class="err">~</span><span class="cp">]</span># kubectl get service
NAME         TYPE        CLUSTER-IP     EXTERNAL-IP   PORT(S)   AGE
kubernetes   ClusterIP   10.96.0.1      <span class="nt">&lt;none&gt;</span>        443/TCP   3h34m
nginx        ClusterIP   10.96.216.63   <span class="nt">&lt;none&gt;</span>        80/TCP    10s
</pre></div>


<blockquote>
<p>10.96.216.63 service对外地址，代理后端pod</p>
</blockquote>
<h3 id="get">get 显示资源</h3>
<p>即从Kubernetes里面获取指定的API对象</p>
<h4 id="controllerrevision-controller">controllerrevision 记录Controller版本</h4>
<p>用于记录某种Controller对象的版本</p>
<div class="hlcode"><pre><span class="err">$</span> <span class="n">kubectl</span> <span class="n">get</span> <span class="n">controllerrevision</span> <span class="o">-</span><span class="n">n</span> <span class="n">kube</span><span class="o">-</span><span class="n">system</span> <span class="o">-</span><span class="n">l</span> <span class="n">name</span><span class="o">=</span><span class="n">fluentd</span><span class="o">-</span><span class="n">elasticsearch</span>
<span class="n">NAME</span>                               <span class="n">CONTROLLER</span>                             <span class="n">REVISION</span>   <span class="n">AGE</span>
<span class="n">fluentd</span><span class="o">-</span><span class="n">elasticsearch</span><span class="o">-</span><span class="mi">64</span><span class="n">dc6799c9</span>   <span class="n">daemonset</span><span class="p">.</span><span class="n">apps</span><span class="o">/</span><span class="n">fluentd</span><span class="o">-</span><span class="n">elasticsearch</span>   <span class="mi">2</span>          <span class="mi">1</span><span class="n">h</span>
</pre></div>


<blockquote>
<p>查看fluentd-elasticsearch对应的ControllerRevision</p>
</blockquote>
<p>列出所有资源</p>
<div class="hlcode"><pre><span class="n">kubectl</span> <span class="n">get</span> <span class="n">namespaces</span>
</pre></div>


<p>查看多个资源</p>
<div class="hlcode"><pre><span class="n">kubectl</span> <span class="n">get</span> <span class="n">pods</span><span class="p">,</span><span class="n">services</span> <span class="o">-</span><span class="n">o</span> <span class="n">wide</span>
</pre></div>


<h4 id="-l">-l 标签选择器</h4>
<p>列出名称空间中拥有k8s-app标签名称的所有Pod 对象</p>
<div class="hlcode"><pre><span class="n">kubectl</span> <span class="n">get</span> <span class="n">pods</span> <span class="o">-</span><span class="n">l</span> <span class="n">k8s</span><span class="o">-</span><span class="n">app</span> <span class="o">-</span><span class="n">n</span> <span class="n">kube</span><span class="o">-</span><span class="n">system</span>
</pre></div>


<h5 id="_2">等值关系</h5>
<div class="hlcode"><pre><span class="o">=</span><span class="p">,</span> <span class="o">!=</span><span class="p">,</span> <span class="o">==</span>
</pre></div>


<h5 id="_3">集合关系</h5>
<div class="hlcode"><pre><span class="n">KEY</span> <span class="n">in</span> <span class="p">(</span><span class="n">VALUE1</span><span class="p">,</span> <span class="n">VALUE2</span><span class="p">,...)</span>
</pre></div>


<div class="hlcode"><pre><span class="n">KEY</span> <span class="n">notin</span> <span class="p">(</span><span class="n">VALUE1</span><span class="p">,</span> <span class="n">VALUE2</span><span class="p">,...)</span>
</pre></div>


<div class="hlcode"><pre><span class="sx">!KEY</span>
</pre></div>


<h4 id="-l_1">-L 标签列表</h4>
<p>显示每一个对象的标签值</p>
<div class="hlcode"><pre><span class="n">kubectl</span> <span class="n">get</span> <span class="n">pods</span> <span class="o">-</span><span class="n">l</span> <span class="err">&#39;</span><span class="n">env</span> <span class="n">in</span> <span class="p">(</span><span class="n">production</span><span class="p">,</span><span class="n">dev</span><span class="p">),</span><span class="o">!</span><span class="n">tier</span><span class="err">&#39;</span> <span class="o">-</span><span class="n">L</span> <span class="n">env</span><span class="p">,</span><span class="n">tier</span>
</pre></div>


<h4 id="-o">-o 输出</h4>
<h5 id="yaml">yaml</h5>
<div class="hlcode"><pre><span class="n">kubectl</span> <span class="n">get</span> <span class="n">pods</span> <span class="o">-</span><span class="n">l</span> <span class="n">component</span><span class="o">=</span><span class="n">kube</span><span class="o">=</span><span class="n">apiserver</span> <span class="o">-</span><span class="n">o</span> <span class="n">yaml</span> <span class="o">-</span><span class="n">n</span> <span class="n">kube</span><span class="o">-</span><span class="n">system</span>
</pre></div>


<h5 id="json">json</h5>
<h5 id="wide">wide 额外信息</h5>
<p>显示资源的额外信息</p>
<div class="hlcode"><pre><span class="n">kubectl</span> <span class="n">get</span> <span class="n">pods</span> <span class="o">-</span><span class="n">o</span> <span class="n">wide</span> 
</pre></div>


<h5 id="name">name 名称</h5>
<p>仅仅打印资源名称</p>
<h5 id="go-template-go">go-template go 模版</h5>
<p>以自定义的go模版格式化输出API对象信息</p>
<h5 id="custom-columns">custom-columns 自定义输出</h5>
<p>自定义要输出的字段</p>
<h5 id="nodes">nodes</h5>
<p>查看键名为SSD标签的node资源</p>
<div class="hlcode"><pre><span class="n">kubectl</span> <span class="n">get</span> <span class="n">nodes</span> <span class="o">-</span><span class="n">l</span> <span class="err">&#39;</span><span class="n">disktype</span><span class="err">&#39;</span> <span class="o">-</span><span class="n">L</span> <span class="n">disktype</span>
</pre></div>


<h3 id="run">run 运行</h3>
<p>通过创建Deployment在集群中运行指定的镜像</p>
<div class="hlcode"><pre><span class="n">kubectl</span> <span class="n">run</span> <span class="n">nginx</span><span class="o">-</span><span class="n">deploy</span> <span class="o">--</span><span class="n">image</span><span class="o">=</span><span class="n">nginx</span><span class="o">:</span><span class="mf">1.12</span> <span class="o">--</span><span class="n">replicas</span><span class="o">=</span><span class="mi">2</span>
</pre></div>


<h3 id="set">set 设置属性</h3>
<p>设置指定资源的特定属性</p>
<h4 id="image">image</h4>
<p>Deployment对应用进行版本控制</p>
<div class="hlcode"><pre><span class="err">$</span> <span class="n">kubectl</span> <span class="n">set</span> <span class="n">image</span> <span class="n">deployment</span><span class="o">/</span><span class="n">nginx</span><span class="o">-</span><span class="n">deployment</span> <span class="n">nginx</span><span class="o">=</span><span class="n">nginx</span><span class="o">:</span><span class="mf">1.91</span>
<span class="n">deployment</span><span class="p">.</span><span class="n">extensions</span><span class="o">/</span><span class="n">nginx</span><span class="o">-</span><span class="n">deployment</span> <span class="n">image</span> <span class="n">updated</span>
</pre></div>


<blockquote>
<p>这里的nginx:1.91 是错误的版本</p>
</blockquote>
<h2 id="_4">部署命令</h2>
<h3 id="autoscale">autoscale 自动伸缩</h3>
<p>对Deployment，ReplicaSet或RC进行自动伸缩</p>
<h3 id="scale">scale 扩容/缩容</h3>
<div class="hlcode"><pre><span class="n">kubectl</span> <span class="n">scale</span> <span class="n">deployments</span><span class="o">/</span><span class="n">myapp</span> <span class="o">--</span><span class="n">replicas</span><span class="o">=</span><span class="mi">3</span> 
</pre></div>


<blockquote>
<p>replicas 指明对象创建或管理Pod对象的副本数量</p>
</blockquote>
<div class="hlcode"><pre><span class="n">kubectl</span> <span class="n">scale</span> <span class="n">deployments</span><span class="o">/</span><span class="n">myapp</span> <span class="o">--</span><span class="n">replicas</span><span class="o">=</span><span class="mi">2</span>
</pre></div>


<div class="hlcode"><pre><span class="p">[</span><span class="n">root</span><span class="err">@</span><span class="n">master</span> <span class="o">~</span><span class="p">]</span><span class="err">#</span> <span class="n">kubectl</span> <span class="n">scale</span> <span class="o">--</span><span class="n">replicas</span><span class="o">=</span><span class="mi">5</span> <span class="n">deployment</span> <span class="n">myapp</span>
<span class="n">deployment</span><span class="p">.</span><span class="n">extensions</span><span class="o">/</span><span class="n">myapp</span> <span class="n">scaled</span>
<span class="p">[</span><span class="n">root</span><span class="err">@</span><span class="n">master</span> <span class="o">~</span><span class="p">]</span><span class="err">#</span> <span class="n">kubectl</span> <span class="n">scale</span> <span class="o">--</span><span class="n">replicas</span><span class="o">=</span><span class="mi">1</span> <span class="n">deployment</span> <span class="n">myapp</span>
<span class="n">deployment</span><span class="p">.</span><span class="n">extensions</span><span class="o">/</span><span class="n">myapp</span> <span class="n">scaled</span>
</pre></div>


<h3 id="rollout">rollout 滚动更新</h3>
<p>管理资源的滚动更新</p>
<h4 id="history">history</h4>
<p>查看Deployment 变更的对应版本</p>
<div class="hlcode"><pre><span class="err">$</span> <span class="n">kubectl</span> <span class="n">rollout</span> <span class="n">history</span> <span class="n">deployment</span><span class="o">/</span><span class="n">nginx</span><span class="o">-</span><span class="n">deployment</span>
<span class="n">deployments</span> <span class="s">&quot;nginx-deployment&quot;</span>
<span class="n">REVISION</span>    <span class="n">CHANGE</span><span class="o">-</span><span class="n">CAUSE</span>
<span class="mi">1</span>           <span class="n">kubectl</span> <span class="n">create</span> <span class="o">-</span><span class="n">f</span> <span class="n">nginx</span><span class="o">-</span><span class="n">deployment</span><span class="p">.</span><span class="n">yaml</span> <span class="o">--</span><span class="n">record</span>
<span class="mi">2</span>           <span class="n">kubectl</span> <span class="n">edit</span> <span class="n">deployment</span><span class="o">/</span><span class="n">nginx</span><span class="o">-</span><span class="n">deployment</span>
<span class="mi">3</span>           <span class="n">kubectl</span> <span class="n">set</span> <span class="n">image</span> <span class="n">deployment</span><span class="o">/</span><span class="n">nginx</span><span class="o">-</span><span class="n">deployment</span> <span class="n">nginx</span><span class="o">=</span><span class="n">nginx</span><span class="o">:</span><span class="mf">1.91</span>
</pre></div>


<h4 id="pause">pause</h4>
<p>由于Deployment进行的每一次更新操作，都会生成一个新的ReplicaSet对象，为此，可以指定多次更新操作之后，只生成一个ReplicaSet</p>
<p>即在更新Deployment之前，执行下列操作</p>
<div class="hlcode"><pre><span class="err">$</span> <span class="n">kubectl</span> <span class="n">rollout</span> <span class="n">pause</span> <span class="n">deployment</span><span class="o">/</span><span class="n">nginx</span><span class="o">-</span><span class="n">deployment</span>
<span class="n">deployment</span><span class="p">.</span><span class="n">extensions</span><span class="o">/</span><span class="n">nginx</span><span class="o">-</span><span class="n">deployment</span> <span class="n">paused</span>
</pre></div>


<blockquote>
<p>Deployment将处于暂停状态，这样对Deployment的所有修改，都不会出发滚动更新</p>
</blockquote>
<h4 id="resume">resume</h4>
<p>恢复Deployment 滚动更新</p>
<div class="hlcode"><pre><span class="p">[</span><span class="n">root</span><span class="err">@</span><span class="n">master</span> <span class="o">~</span><span class="p">]</span><span class="err">#</span> <span class="n">kubectl</span> <span class="n">rollout</span> <span class="n">resume</span> <span class="n">deployment</span> <span class="n">myapp</span><span class="o">-</span><span class="n">deployment</span>
<span class="n">deployment</span><span class="p">.</span><span class="n">extensions</span><span class="o">/</span><span class="n">myapp</span><span class="o">-</span><span class="n">deployment</span> <span class="n">resumed</span>
</pre></div>


<p>可以看到更新状况</p>
<div class="hlcode"><pre><span class="p">[</span><span class="n">root</span><span class="err">@</span><span class="n">master</span> <span class="o">~</span><span class="p">]</span><span class="err">#</span> <span class="n">kubectl</span> <span class="n">rollout</span> <span class="n">status</span> <span class="n">deployment</span> <span class="n">myapp</span><span class="o">-</span><span class="n">deployment</span>
<span class="n">Waiting</span> <span class="k">for</span> <span class="n">deployment</span> <span class="s">&quot;myapp-deployment&quot;</span> <span class="n">rollout</span> <span class="n">to</span> <span class="n">finish</span><span class="o">:</span> <span class="mi">1</span> <span class="n">out</span> <span class="n">of</span> <span class="mi">5</span> <span class="n">new</span> <span class="n">replicas</span> <span class="n">have</span> <span class="n">been</span> <span class="n">updated</span><span class="p">...</span>
<span class="n">Waiting</span> <span class="k">for</span> <span class="n">deployment</span> <span class="n">spec</span> <span class="n">update</span> <span class="n">to</span> <span class="n">be</span> <span class="n">observed</span><span class="p">...</span>
<span class="n">Waiting</span> <span class="k">for</span> <span class="n">deployment</span> <span class="n">spec</span> <span class="n">update</span> <span class="n">to</span> <span class="n">be</span> <span class="n">observed</span><span class="p">...</span>
<span class="n">Waiting</span> <span class="k">for</span> <span class="n">deployment</span> <span class="s">&quot;myapp-deployment&quot;</span> <span class="n">rollout</span> <span class="n">to</span> <span class="n">finish</span><span class="o">:</span> <span class="mi">1</span> <span class="n">out</span> <span class="n">of</span> <span class="mi">5</span> <span class="n">new</span> <span class="n">replicas</span> <span class="n">have</span> <span class="n">been</span> <span class="n">updated</span><span class="p">...</span>
<span class="n">Waiting</span> <span class="k">for</span> <span class="n">deployment</span> <span class="s">&quot;myapp-deployment&quot;</span> <span class="n">rollout</span> <span class="n">to</span> <span class="n">finish</span><span class="o">:</span> <span class="mi">1</span> <span class="n">out</span> <span class="n">of</span> <span class="mi">5</span> <span class="n">new</span> <span class="n">replicas</span> <span class="n">have</span> <span class="n">been</span> <span class="n">updated</span><span class="p">...</span>
<span class="n">Waiting</span> <span class="k">for</span> <span class="n">deployment</span> <span class="s">&quot;myapp-deployment&quot;</span> <span class="n">rollout</span> <span class="n">to</span> <span class="n">finish</span><span class="o">:</span> <span class="mi">2</span> <span class="n">out</span> <span class="n">of</span> <span class="mi">5</span> <span class="n">new</span> <span class="n">replicas</span> <span class="n">have</span> <span class="n">been</span> <span class="n">updated</span><span class="p">...</span>
<span class="n">Waiting</span> <span class="k">for</span> <span class="n">deployment</span> <span class="s">&quot;myapp-deployment&quot;</span> <span class="n">rollout</span> <span class="n">to</span> <span class="n">finish</span><span class="o">:</span> <span class="mi">2</span> <span class="n">out</span> <span class="n">of</span> <span class="mi">5</span> <span class="n">new</span> <span class="n">replicas</span> <span class="n">have</span> <span class="n">been</span> <span class="n">updated</span><span class="p">...</span>
<span class="n">Waiting</span> <span class="k">for</span> <span class="n">deployment</span> <span class="s">&quot;myapp-deployment&quot;</span> <span class="n">rollout</span> <span class="n">to</span> <span class="n">finish</span><span class="o">:</span> <span class="mi">2</span> <span class="n">out</span> <span class="n">of</span> <span class="mi">5</span> <span class="n">new</span> <span class="n">replicas</span> <span class="n">have</span> <span class="n">been</span> <span class="n">updated</span><span class="p">...</span>
<span class="n">Waiting</span> <span class="k">for</span> <span class="n">deployment</span> <span class="s">&quot;myapp-deployment&quot;</span> <span class="n">rollout</span> <span class="n">to</span> <span class="n">finish</span><span class="o">:</span> <span class="mi">3</span> <span class="n">out</span> <span class="n">of</span> <span class="mi">5</span> <span class="n">new</span> <span class="n">replicas</span> <span class="n">have</span> <span class="n">been</span> <span class="n">updated</span><span class="p">...</span>
<span class="n">Waiting</span> <span class="k">for</span> <span class="n">deployment</span> <span class="s">&quot;myapp-deployment&quot;</span> <span class="n">rollout</span> <span class="n">to</span> <span class="n">finish</span><span class="o">:</span> <span class="mi">3</span> <span class="n">out</span> <span class="n">of</span> <span class="mi">5</span> <span class="n">new</span> <span class="n">replicas</span> <span class="n">have</span> <span class="n">been</span> <span class="n">updated</span><span class="p">...</span>
<span class="n">Waiting</span> <span class="k">for</span> <span class="n">deployment</span> <span class="s">&quot;myapp-deployment&quot;</span> <span class="n">rollout</span> <span class="n">to</span> <span class="n">finish</span><span class="o">:</span> <span class="mi">4</span> <span class="n">out</span> <span class="n">of</span> <span class="mi">5</span> <span class="n">new</span> <span class="n">replicas</span> <span class="n">have</span> <span class="n">been</span> <span class="n">updated</span><span class="p">...</span>
<span class="n">Waiting</span> <span class="k">for</span> <span class="n">deployment</span> <span class="s">&quot;myapp-deployment&quot;</span> <span class="n">rollout</span> <span class="n">to</span> <span class="n">finish</span><span class="o">:</span> <span class="mi">4</span> <span class="n">out</span> <span class="n">of</span> <span class="mi">5</span> <span class="n">new</span> <span class="n">replicas</span> <span class="n">have</span> <span class="n">been</span> <span class="n">updated</span><span class="p">...</span>
<span class="n">Waiting</span> <span class="k">for</span> <span class="n">deployment</span> <span class="s">&quot;myapp-deployment&quot;</span> <span class="n">rollout</span> <span class="n">to</span> <span class="n">finish</span><span class="o">:</span> <span class="mi">4</span> <span class="n">out</span> <span class="n">of</span> <span class="mi">5</span> <span class="n">new</span> <span class="n">replicas</span> <span class="n">have</span> <span class="n">been</span> <span class="n">updated</span><span class="p">...</span>
<span class="n">Waiting</span> <span class="k">for</span> <span class="n">deployment</span> <span class="s">&quot;myapp-deployment&quot;</span> <span class="n">rollout</span> <span class="n">to</span> <span class="n">finish</span><span class="o">:</span> <span class="mi">4</span> <span class="n">out</span> <span class="n">of</span> <span class="mi">5</span> <span class="n">new</span> <span class="n">replicas</span> <span class="n">have</span> <span class="n">been</span> <span class="n">updated</span><span class="p">...</span>
<span class="n">Waiting</span> <span class="k">for</span> <span class="n">deployment</span> <span class="s">&quot;myapp-deployment&quot;</span> <span class="n">rollout</span> <span class="n">to</span> <span class="n">finish</span><span class="o">:</span> <span class="mi">1</span> <span class="n">old</span> <span class="n">replicas</span> <span class="n">are</span> <span class="n">pending</span> <span class="n">termination</span><span class="p">...</span>
<span class="n">Waiting</span> <span class="k">for</span> <span class="n">deployment</span> <span class="s">&quot;myapp-deployment&quot;</span> <span class="n">rollout</span> <span class="n">to</span> <span class="n">finish</span><span class="o">:</span> <span class="mi">1</span> <span class="n">old</span> <span class="n">replicas</span> <span class="n">are</span> <span class="n">pending</span> <span class="n">termination</span><span class="p">...</span>
<span class="n">deployment</span> <span class="s">&quot;myapp-deployment&quot;</span> <span class="n">successfully</span> <span class="n">rolled</span> <span class="n">out</span>
</pre></div>


<h4 id="status">status</h4>
<p>监听更新状态</p>
<div class="hlcode"><pre><span class="p">[</span><span class="n">root</span><span class="err">@</span><span class="n">master</span> <span class="o">~</span><span class="p">]</span><span class="err">#</span> <span class="n">kubectl</span> <span class="n">rollout</span> <span class="n">status</span> <span class="n">deployment</span> <span class="n">myapp</span><span class="o">-</span><span class="n">deployment</span>
<span class="n">Waiting</span> <span class="k">for</span> <span class="n">deployment</span> <span class="s">&quot;myapp-deployment&quot;</span> <span class="n">rollout</span> <span class="n">to</span> <span class="n">finish</span><span class="o">:</span> <span class="mi">1</span> <span class="n">out</span> <span class="n">of</span> <span class="mi">5</span> <span class="n">new</span> <span class="n">replicas</span> <span class="n">have</span> <span class="n">been</span> <span class="n">updated</span><span class="p">...</span>
</pre></div>


<h4 id="undo">undo</h4>
<p>撤销滚动版本, 默认为上一个版本</p>
<div class="hlcode"><pre><span class="err">$</span> <span class="n">kubectl</span> <span class="n">rollout</span> <span class="n">undo</span> <span class="n">deployment</span><span class="o">/</span><span class="n">nginx</span><span class="o">-</span><span class="n">deployment</span> <span class="o">--</span><span class="n">to</span><span class="o">-</span><span class="n">revision</span><span class="o">=</span><span class="mi">2</span>
<span class="n">deployment</span><span class="p">.</span><span class="n">extensions</span><span class="o">/</span><span class="n">nginx</span><span class="o">-</span><span class="n">deployment</span>
</pre></div>


<blockquote>
<p>这里指定了滚动的版本号</p>
</blockquote>
<div class="hlcode"><pre><span class="cp">[</span><span class="nb">root</span><span class="p">@</span><span class="nx">master</span> <span class="err">~</span><span class="cp">]</span># kubectl rollout history deployment myapp-deployment
deployment.extensions/myapp-deployment
REVISION  CHANGE-CAUSE
1         <span class="nt">&lt;none&gt;</span>
2         <span class="nt">&lt;none&gt;</span>
3         <span class="nt">&lt;none&gt;</span>

<span class="cp">[</span><span class="nb">root</span><span class="p">@</span><span class="nx">master</span> <span class="err">~</span><span class="cp">]</span># kubectl rollout undo deployment myapp-deployment --to-revision=1
deployment.extensions/myapp-deployment rolled back
<span class="cp">[</span><span class="nb">root</span><span class="p">@</span><span class="nx">master</span> <span class="err">~</span><span class="cp">]</span>#
<span class="cp">[</span><span class="nb">root</span><span class="p">@</span><span class="nx">master</span> <span class="err">~</span><span class="cp">]</span># kubectl rollout history deployment myapp-deployment
deployment.extensions/myapp-deployment
REVISION  CHANGE-CAUSE
2         <span class="nt">&lt;none&gt;</span>
3         <span class="nt">&lt;none&gt;</span>
4         <span class="nt">&lt;none&gt;</span>
</pre></div>


<blockquote>
<p>这里的4 表示revision号码变动了</p>
</blockquote>
<h3 id="rolling-update">rolling-update 滚动升级</h3>
<p>对ReplicationController执行滚动升级</p>
<h2 id="_5">集群管理</h2>
<h3 id="certificate">certificate 数字证书</h3>
<p>配置数字证书资源</p>
<h3 id="cluster-info">cluster-info 集群信息</h3>
<p>打印集群信息</p>
<h3 id="cordon">cordon 不可用状态</h3>
<p>指定node 设定为不可用（unschedulable）状态</p>
<h3 id="drain">drain 维护模式</h3>
<p>值得node的负载以进入维护模式</p>
<h3 id="top">top 使用率</h3>
<p>打印资源（cpu/memory/storage） 使用率</p>
<h3 id="taint">taint 声明污点</h3>
<p>为node声明污点及标准行为</p>
<h3 id="uncordon">uncordon 可用状态</h3>
<p>指定node 设定为可用（schedulable）状态</p>
<h2 id="_6">排错调试</h2>
<h3 id="attach">attach 附加终端</h3>
<p>附加终端至一个运行中的容器</p>
<div class="hlcode"><pre><span class="n">apiVersion</span><span class="o">:</span> <span class="n">v1</span>
<span class="n">kind</span><span class="o">:</span> <span class="n">Pod</span>
<span class="n">metadata</span><span class="o">:</span>
  <span class="n">name</span><span class="o">:</span> <span class="n">nginx</span>
<span class="n">spec</span><span class="o">:</span>
  <span class="n">shareProcessNamespace</span><span class="o">:</span> <span class="kc">true</span>
  <span class="n">containers</span><span class="o">:</span>
  <span class="o">-</span> <span class="n">name</span><span class="o">:</span> <span class="n">nginx</span>
    <span class="n">image</span><span class="o">:</span> <span class="n">nginx</span>
  <span class="o">-</span> <span class="n">name</span><span class="o">:</span> <span class="n">shell</span>
    <span class="n">image</span><span class="o">:</span> <span class="n">busybox</span>
    <span class="n">stdin</span><span class="o">:</span> <span class="kc">true</span>
    <span class="n">tty</span><span class="o">:</span> <span class="kc">true</span>
</pre></div>


<div class="hlcode"><pre><span class="n">kubectl</span> <span class="n">attach</span> <span class="o">-</span><span class="n">it</span> <span class="n">nginx</span> <span class="o">-</span><span class="n">c</span> <span class="n">shell</span>
</pre></div>


<h3 id="auth">auth 授权信息</h3>
<p>打印授权信息</p>
<h3 id="cp">cp 复制</h3>
<p>在容器间复制文件或者目录</p>
<h3 id="exec">exec 执行命令</h3>
<p>容器内执行命令</p>
<div class="hlcode"><pre><span class="n">kubectl</span> <span class="n">exec</span> <span class="n">kube</span><span class="o">-</span><span class="n">apiserver</span><span class="o">-</span><span class="n">master</span><span class="p">.</span><span class="n">xuxuehua</span><span class="p">.</span><span class="n">com</span> <span class="o">-</span><span class="n">n</span> <span class="n">kube</span><span class="o">-</span><span class="n">system</span> <span class="o">--</span><span class="n">ps</span>
</pre></div>


<blockquote>
<p>Pod对象中的容器里面运行ps命令</p>
</blockquote>
<h4 id="-it-shell">-it 交互Shell</h4>
<div class="hlcode"><pre><span class="n">kubectl</span> <span class="n">exec</span> <span class="o">-</span><span class="n">it</span> <span class="err">$</span><span class="n">POD_NAME</span> <span class="o">/</span><span class="n">bin</span><span class="o">/</span><span class="n">sh</span>
</pre></div>


<h3 id="describe">describe 详细信息</h3>
<div class="hlcode"><pre><span class="n">kubectl</span> <span class="n">describe</span> <span class="p">(</span><span class="o">-</span><span class="n">f</span> <span class="n">FILENAME</span> <span class="o">|</span> <span class="n">TYPE</span> <span class="p">[</span><span class="n">NAME_PREFIX</span> <span class="o">|</span> <span class="o">-</span><span class="n">l</span> <span class="n">label</span><span class="p">]</span> <span class="o">|</span> <span class="n">TYPE</span><span class="o">/</span><span class="n">NAME</span><span class="p">)</span>
</pre></div>


<h4 id="pod">pod</h4>
<p>指定pod查看一个API对象的细节</p>
<p>显示指定的资源或者资源组的详细信息</p>
<div class="hlcode"><pre><span class="n">kubectl</span> <span class="n">describe</span> <span class="n">pods</span> <span class="o">-</span><span class="n">l</span> <span class="n">component</span><span class="o">=</span><span class="n">kube</span><span class="o">-</span><span class="n">apiserver</span> <span class="o">-</span><span class="n">n</span> <span class="n">kube</span><span class="o">-</span><span class="n">system</span>
</pre></div>


<div class="hlcode"><pre><span class="n">kubectl</span> <span class="n">describe</span> <span class="n">services</span> <span class="n">myapp</span><span class="o">-</span><span class="n">svc</span>
</pre></div>


<h4 id="servicesvc">service/svc</h4>
<p>查看service 对象</p>
<div class="hlcode"><pre><span class="cp">[</span><span class="nb">root</span><span class="p">@</span><span class="nx">master</span> <span class="err">~</span><span class="cp">]</span># kubectl describe svc nginx
Name:              nginx
Namespace:         default
Labels:            run=nginx-deploy
Annotations:       <span class="nt">&lt;none&gt;</span>
Selector:          run=nginx-deploy
Type:              ClusterIP
IP:                10.96.216.63
Port:              <span class="nt">&lt;unset&gt;</span>  80/TCP
TargetPort:        80/TCP
Endpoints:         10.244.2.2:80
Session Affinity:  None
Events:            <span class="nt">&lt;none&gt;</span>
</pre></div>


<blockquote>
<p>这里指定了pod标签，因此才可以查看到对应的信息</p>
</blockquote>
<div class="hlcode"><pre><span class="p">[</span><span class="n">root</span><span class="err">@</span><span class="n">master</span> <span class="o">~</span><span class="p">]</span><span class="err">#</span> <span class="n">kubectl</span> <span class="n">get</span> <span class="n">pods</span> <span class="o">--</span><span class="n">show</span><span class="o">-</span><span class="n">labels</span>
<span class="n">NAME</span>                           <span class="n">READY</span>   <span class="n">STATUS</span>    <span class="n">RESTARTS</span>   <span class="n">AGE</span>   <span class="n">LABELS</span>
<span class="n">client</span>                         <span class="mi">0</span><span class="o">/</span><span class="mi">1</span>     <span class="n">Error</span>     <span class="mi">0</span>          <span class="mi">19</span><span class="n">m</span>   <span class="n">run</span><span class="o">=</span><span class="n">client</span>
<span class="n">nginx</span><span class="o">-</span><span class="n">deploy</span><span class="o">-</span><span class="mi">55</span><span class="n">d8d67cf</span><span class="o">-</span><span class="mi">7</span><span class="n">zkxm</span>   <span class="mi">1</span><span class="o">/</span><span class="mi">1</span>     <span class="n">Running</span>   <span class="mi">0</span>          <span class="mi">9</span><span class="n">h</span>    <span class="n">pod</span><span class="o">-</span><span class="n">template</span><span class="o">-</span><span class="n">hash</span><span class="o">=</span><span class="mi">55</span><span class="n">d8d67cf</span><span class="p">,</span><span class="n">run</span><span class="o">=</span><span class="n">nginx</span><span class="o">-</span><span class="n">deploy</span>
</pre></div>


<h3 id="loglogs">log/logs 日志</h3>
<p>pod内某容器的日志</p>
<div class="hlcode"><pre><span class="n">kubectl</span> <span class="n">log</span> <span class="p">[</span><span class="o">-</span><span class="n">f</span><span class="p">]</span> <span class="p">[</span><span class="o">-</span><span class="n">p</span><span class="p">]</span> <span class="p">(</span><span class="n">POD</span><span class="o">|</span><span class="n">TYPE</span><span class="o">/</span><span class="n">NAME</span><span class="p">)</span> <span class="p">[</span><span class="o">-</span><span class="n">c</span> <span class="n">CONTAINER</span><span class="p">]</span> <span class="p">[</span><span class="n">options</span><span class="p">]</span> 
</pre></div>


<blockquote>
<p>-f 类似于tail -f</p>
</blockquote>
<div class="hlcode"><pre><span class="n">kubectl</span> <span class="n">logs</span> <span class="n">kube</span><span class="o">-</span><span class="n">apiserver</span><span class="o">-</span><span class="n">master</span><span class="p">.</span><span class="n">xuxuehua</span><span class="p">.</span><span class="n">com</span> <span class="o">-</span><span class="n">n</span> <span class="n">kube</span><span class="o">-</span><span class="n">system</span>
</pre></div>


<h4 id="-c">-c 指定容器名称</h4>
<h3 id="port-forward">port-forward 端口转发</h3>
<p>将本地的一个或着多个端口转发至指定的pod</p>
<h3 id="proxy-api-server">proxy API Server代理</h3>
<p>能够访问Kubernetes API Server的代理</p>
<h2 id="_7">高级命令</h2>
<h3 id="apply">apply 实现声明</h3>
<p>既可以创建，也可以更新</p>
<p>基于文件或者stdin 将配置应用于资源</p>
<div class="hlcode"><pre><span class="n">kubectl</span> <span class="n">apply</span> <span class="o">-</span><span class="n">f</span> <span class="n">nginx</span><span class="o">-</span><span class="n">deploy</span><span class="p">.</span><span class="n">yaml</span> <span class="o">-</span><span class="n">f</span> <span class="n">nginx</span><span class="o">-</span><span class="n">svc</span><span class="p">.</span><span class="n">yaml</span>
</pre></div>


<h3 id="convert-api">convert API转换</h3>
<p>为不通的API版本转换配置文件</p>
<h3 id="patch">patch 补丁更新</h3>
<p>使用策略合并补丁更新资源字段</p>
<h3 id="replace">replace 替换资源</h3>
<p>基于文件或者stdin替换一个资源</p>
<h2 id="_8">设置命令</h2>
<h3 id="annotate">annotate 资源注释</h3>
<p>添加资源注释</p>
<div class="hlcode"><pre><span class="n">kubectl</span> <span class="n">annotate</span> <span class="n">pods</span> <span class="n">pod</span><span class="o">-</span><span class="n">example</span> <span class="n">ilinux</span><span class="p">.</span><span class="n">io</span><span class="o">/</span><span class="n">created</span><span class="o">-</span><span class="n">by</span><span class="o">=</span><span class="s">&quot;cluster admin&quot;</span>
</pre></div>


<p>查看注解</p>
<div class="hlcode"><pre><span class="n">kubectl</span> <span class="n">describe</span> <span class="n">pods</span> <span class="n">pod</span><span class="o">-</span><span class="n">example</span> <span class="o">|</span> <span class="n">grep</span> <span class="s">&quot;Annotations&quot;</span>
</pre></div>


<h3 id="completion">completion 补全码</h3>
<p>输出指定的shell （bash） 的补全码</p>
<h3 id="label">label 资源标签</h3>
<p>更新指定资源标签</p>
<div class="hlcode"><pre><span class="n">kubectl</span> <span class="n">label</span> <span class="p">[</span><span class="o">--</span><span class="n">overwrite</span><span class="p">]</span> <span class="p">(</span><span class="o">-</span><span class="n">f</span> <span class="n">FILENAME</span> <span class="o">|</span> <span class="n">TYPE</span> <span class="n">NAME</span><span class="p">)</span> <span class="n">KEY_1</span><span class="o">=</span><span class="n">VAL_1</span> <span class="p">...</span> <span class="n">KEY_N</span><span class="o">=</span><span class="n">VAL_N</span>
<span class="p">[</span><span class="o">--</span><span class="n">resource</span><span class="o">-</span><span class="n">version</span><span class="o">=</span><span class="n">version</span><span class="p">]</span> <span class="p">[</span><span class="n">options</span><span class="p">]</span>
</pre></div>


<h4 id="_9">添加标签</h4>
<p>为pod-example 添加env=production 标签</p>
<div class="hlcode"><pre><span class="n">kubectl</span> <span class="n">label</span> <span class="n">pods</span><span class="o">/</span><span class="n">pod</span><span class="o">-</span><span class="n">example</span> <span class="n">env</span><span class="o">=</span><span class="n">production</span>
</pre></div>


<div class="hlcode"><pre><span class="p">[</span><span class="n">root</span><span class="err">@</span><span class="n">master</span> <span class="o">~</span><span class="p">]</span><span class="err">#</span> <span class="n">kubectl</span> <span class="n">label</span> <span class="n">pods</span> <span class="n">pod</span><span class="o">-</span><span class="n">demo</span> <span class="n">release</span><span class="o">=</span><span class="n">canary</span>
<span class="n">pod</span><span class="o">/</span><span class="n">pod</span><span class="o">-</span><span class="n">demo</span> <span class="n">labeled</span>
<span class="p">[</span><span class="n">root</span><span class="err">@</span><span class="n">master</span> <span class="o">~</span><span class="p">]</span><span class="err">#</span> <span class="n">kubectl</span> <span class="n">get</span> <span class="n">pods</span> <span class="o">-</span><span class="n">l</span> <span class="n">app</span> <span class="o">--</span><span class="n">show</span><span class="o">-</span><span class="n">labels</span>
<span class="n">NAME</span>       <span class="n">READY</span>   <span class="n">STATUS</span>    <span class="n">RESTARTS</span>   <span class="n">AGE</span>     <span class="n">LABELS</span>
<span class="n">pod</span><span class="o">-</span><span class="n">demo</span>   <span class="mi">2</span><span class="o">/</span><span class="mi">2</span>     <span class="n">Running</span>   <span class="mi">0</span>          <span class="mi">6</span><span class="n">m17s</span>   <span class="n">app</span><span class="o">=</span><span class="n">myapp</span><span class="p">,</span><span class="n">release</span><span class="o">=</span><span class="n">canary</span><span class="p">,</span><span class="n">tier</span><span class="o">=</span><span class="n">frontend</span>
</pre></div>


<h4 id="-overwrite">覆盖标签 --overwrite</h4>
<div class="hlcode"><pre><span class="p">[</span><span class="n">root</span><span class="err">@</span><span class="n">master</span> <span class="o">~</span><span class="p">]</span><span class="err">#</span> <span class="n">kubectl</span> <span class="n">label</span> <span class="n">pods</span> <span class="n">pod</span><span class="o">-</span><span class="n">demo</span> <span class="n">release</span><span class="o">=</span><span class="n">canary</span>
<span class="n">pod</span><span class="o">/</span><span class="n">pod</span><span class="o">-</span><span class="n">demo</span> <span class="n">labeled</span>
<span class="p">[</span><span class="n">root</span><span class="err">@</span><span class="n">master</span> <span class="o">~</span><span class="p">]</span><span class="err">#</span> <span class="n">kubectl</span> <span class="n">get</span> <span class="n">pods</span> <span class="o">-</span><span class="n">l</span> <span class="n">app</span> <span class="o">--</span><span class="n">show</span><span class="o">-</span><span class="n">labels</span>
<span class="n">NAME</span>       <span class="n">READY</span>   <span class="n">STATUS</span>    <span class="n">RESTARTS</span>   <span class="n">AGE</span>     <span class="n">LABELS</span>
<span class="n">pod</span><span class="o">-</span><span class="n">demo</span>   <span class="mi">2</span><span class="o">/</span><span class="mi">2</span>     <span class="n">Running</span>   <span class="mi">0</span>          <span class="mi">6</span><span class="n">m17s</span>   <span class="n">app</span><span class="o">=</span><span class="n">myapp</span><span class="p">,</span><span class="n">release</span><span class="o">=</span><span class="n">canary</span><span class="p">,</span><span class="n">tier</span><span class="o">=</span><span class="n">frontend</span>
<span class="p">[</span><span class="n">root</span><span class="err">@</span><span class="n">master</span> <span class="o">~</span><span class="p">]</span><span class="err">#</span> <span class="n">kubectl</span> <span class="n">label</span> <span class="n">pods</span> <span class="n">pod</span><span class="o">-</span><span class="n">demo</span> <span class="n">release</span><span class="o">=</span><span class="n">stable</span> <span class="o">--</span><span class="n">overwrite</span>
<span class="n">pod</span><span class="o">/</span><span class="n">pod</span><span class="o">-</span><span class="n">demo</span> <span class="n">labeled</span>
<span class="p">[</span><span class="n">root</span><span class="err">@</span><span class="n">master</span> <span class="o">~</span><span class="p">]</span><span class="err">#</span> <span class="n">kubectl</span> <span class="n">get</span> <span class="n">pods</span> <span class="o">-</span><span class="n">l</span> <span class="n">app</span> <span class="o">--</span><span class="n">show</span><span class="o">-</span><span class="n">labels</span>
<span class="n">NAME</span>       <span class="n">READY</span>   <span class="n">STATUS</span>    <span class="n">RESTARTS</span>   <span class="n">AGE</span>     <span class="n">LABELS</span>
<span class="n">pod</span><span class="o">-</span><span class="n">demo</span>   <span class="mi">2</span><span class="o">/</span><span class="mi">2</span>     <span class="n">Running</span>   <span class="mi">0</span>          <span class="mi">7</span><span class="n">m13s</span>   <span class="n">app</span><span class="o">=</span><span class="n">myapp</span><span class="p">,</span><span class="n">release</span><span class="o">=</span><span class="n">stable</span><span class="p">,</span><span class="n">tier</span><span class="o">=</span><span class="n">frontend</span>
</pre></div>


<h4 id="nodes_1">nodes</h4>
<p>设置标签以及标识</p>
<div class="hlcode"><pre><span class="n">kubectl</span> <span class="n">label</span> <span class="n">nodes</span> <span class="n">node01</span><span class="p">.</span><span class="n">xurick</span><span class="p">.</span><span class="n">com</span> <span class="n">disktype</span><span class="o">=</span><span class="n">ssd</span>
</pre></div>


<p>查看键名为SSD标签的node资源</p>
<div class="hlcode"><pre><span class="n">kubectl</span> <span class="n">get</span> <span class="n">nodes</span> <span class="o">-</span><span class="n">l</span> <span class="err">&#39;</span><span class="n">disktype</span><span class="err">&#39;</span> <span class="o">-</span><span class="n">L</span> <span class="n">disktype</span>
</pre></div>


<h2 id="_10">其他命令</h2>
<h3 id="api-versions-api">api-versions API版本信息</h3>
<p>以group/version格式打印服务器支持的API版本信息</p>
<h3 id="config">config 配置内容</h3>
<p>配置kubeconfig文件的内容</p>
<h3 id="help">help 帮助</h3>
<p>打印任意命令的帮助信息</p>
<h3 id="option">option 通用选项</h3>
<h4 id="-s-server-api-server">-s / --server 指定API Server</h4>
<p>指定API Server的地址和端口</p>
<h4 id="-kubeconfig">--kubeconfig 文件路径</h4>
<p>是用kubeconfig 文件路径，默认为<code>~/.kube/config</code></p>
<h4 id="-namespace">--namespace 名称空间</h4>
<p>命令执行的目标名称空间</p>
<h3 id="plugin">plugin 命令行插件</h3>
<p>运行命令行插件</p>
<h3 id="version">version 版本信息</h3>
<p>打印Kubernetes的服务器端和客户端版本信息</p>
    </div>
    <div id="footer">
      <span>
        <p>Copyright © 2019 Xu XueHua.
        Powered by <a href="http://simiki.org/" target="_blank">Simiki</a>.</p>
        <p>Site Generated 2019-05-20 00:38:30</p>
      </span>
    </div>

    
    
  </body>
</html>
<!DOCTYPE HTML>
<html>
  <head>
    <link rel="Stylesheet" type="text/css" href="/static/css/style.css">
    <link rel="Stylesheet" type="text/css" href="/static/css/tango.css">
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <link rel="alternate" type="application/atom+xml" href="atom.xml" title="Atom feed">
    <title>network - Xu XueHua</title>
    <meta name="keywords" content="Xu XueHua"/>
    <meta name="description" content="Xu XueHua's public notes"/>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  </head>

  <body>
    <div id="container">
      
<div id="header">
  <div class="post-nav"><a href="/">Home</a>&nbsp;&#187;&nbsp;<a href="/#Kubernetes">Kubernetes</a>&nbsp;&#187;&nbsp;network
    <span class="updated">Page Updated&nbsp;
      2019-03-29 14:02
    </span></div>
</div>
<div class="clearfix"></div>

<div class="page_title">network</div>

  <div class="toc"><span class="toctitle">Table of Contents</span><ul>
<li><a href="#kubernetes">Kubernetes 网络</a><ul>
<li><a href="#node">Node 节点网络 (网络独立)</a></li>
<li><a href="#servicecluster">Service/cluster 集群网络 (网络独立)</a></li>
<li><a href="#pod">Pod 网络 (网络独立)</a><ul>
<li><a href="#_1">容器间通信</a></li>
<li><a href="#pod_1">各Pod之间通信</a></li>
<li><a href="#podservice">Pod与service通信</a></li>
</ul>
</li>
<li><a href="#cni">CNI</a><ul>
<li><a href="#flannel">flannel</a></li>
<li><a href="#calico">calico</a></li>
<li><a href="#canel">canel</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<h1 id="kubernetes">Kubernetes 网络</h1>
<p>外部请求，顺序为node代理至service， service代理至Pod</p>
<p><img alt="img" src="https://snag.gy/H8Oely.jpg" /></p>
<h2 id="node">Node 节点网络 (网络独立)</h2>
<p>在构建之前，配置完成节点间的网络通信</p>
<h2 id="servicecluster">Service/cluster 集群网络 (网络独立)</h2>
<p>虚拟地址， 仅存在于iptables 和ipvs中，即iptables规则中的地址</p>
<p>通过kube-proxy在每个节点上创建规则，实现管控</p>
<p>每次网络变更的实现，都是有kube-proxy在每一个节点上创建规则</p>
<p>每一个service的变动，也需要kube-proxy反应的规则上</p>
<h2 id="pod">Pod 网络 (网络独立)</h2>
<p>Pod内部可相互访问</p>
<h3 id="_1">容器间通信</h3>
<p>通过lo接口通信</p>
<h3 id="pod_1">各Pod之间通信</h3>
<p>各Pod通过自己的地址直接通信，也就是每个Pod的地址是独立的</p>
<p>通过Overlay network的隧道方式完成Pod之间的通信，可以转发二层报文，也可以转发三层报文</p>
<h3 id="podservice">Pod与service通信</h3>
<p>通过kube-proxy实现</p>
<h2 id="cni">CNI</h2>
<p>Container Network Interface </p>
<p>需要第三方工具提供网络规则的方式，以隔绝网络中非同一业务的Pod之间的网络通信</p>
<h3 id="flannel">flannel</h3>
<p>仅支持网络配置，不支持网络策略</p>
<p>叠加网络实现</p>
<h3 id="calico">calico</h3>
<p>支持网络配置，网络策略</p>
<p>支持BGP协议，实现之间通信</p>
<h3 id="canel">canel</h3>
<p>结合calico和flannel</p>
    </div>
    <div id="footer">
      <span>
        <p>Copyright © 2019 Xu XueHua.
        Powered by <a href="http://simiki.org/" target="_blank">Simiki</a>.</p>
        <p>Site Generated 2019-11-05 22:57:24</p>
      </span>
    </div>

    
    
  </body>
</html>